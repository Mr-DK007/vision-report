Locator headers = page.locator("//div[contains(@class,'ag-header-cell-text')]");
Locator rows = page.locator("//div[contains(@class,'ag-center-cols-container')]//div[contains(@class,'ag-row')]");

Map<String, List<String>> tableData = new LinkedHashMap<>();

int headerCount = headers.count();
for (int col = 0; col < headerCount; col++) {
    Locator headerCell = headers.nth(col);
    headerCell.scrollIntoViewIfNeeded();  // ✅ auto scrolls so header is visible
    String header = headerCell.innerText().trim();
    tableData.putIfAbsent(header, new ArrayList<>());

    int rowCount = rows.count();
    for (int r = 0; r < rowCount; r++) {
        Locator rowCell = rows.nth(r).locator(".//div[contains(@class,'ag-cell')]").nth(col);
        rowCell.scrollIntoViewIfNeeded(); // ✅ makes sure cell is rendered
        String value = rowCell.innerText().trim();
        tableData.get(header).add(value);
    }
}
