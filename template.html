<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1320, initial-scale=1.0">
    <title>UI Testing - Vision Report</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='32' fill='%232786d4'/%3E%3Ctext x='32' y='32' text-anchor='middle' dominant-baseline='central' font-family='Arial,sans-serif' font-size='24' font-weight='bold' fill='white'%3EVR%3C/text%3E%3C/svg%3E">
    <style>
        /* Common Variables */
        :root {
            --header-height: 60px;
            --sidebar-width: 80px;
            --bg-color: #e6e7ee;
            --border-color: #d1d9e6;
            --text-color: #495057;
            --text-muted: #7b8ca0;

            --secondary-color-rgb: 123, 140, 160;

            --primary-color: #2786d4;
            --primary-color-rgb: 39, 134, 212;

            --accent-color: #9c27b0;
            --accent-color-rgb: 156, 39, 176;

            --success-color: #4caf50;
            --success-color-rgb: 76, 175, 80;

            --danger-color: #f44336;
            --danger-color-rgb: 244, 67, 54;

            --warning-color: #ff9800;
            --warning-color-rgb: 255, 152, 0;

            --info-color: #2196f3;
            --info-color-rgb: 33, 150, 243;

            --shadow-soft: 2px 2px 4px #b8b9be, -2px -2px 4px #fff;
            --shadow-inset: inset 2px 2px 4px #b8b9be, inset -2px -2px 4px #fff;
            --font-family: 'Calibri', sans-serif;
            --transition-speed: 0.2s;
        }

        /* Dark mode variables */
        [data-theme="dark"] {
            --bg-color: #2c3138;
            --border-color: #3c4653bd;
            --text-color: #e5ecf3;
            --text-muted: #98a4b8;
            --primary-color: #64b5f6;
            --accent-color: #ce93d8;
            --shadow-soft: 2px 2px 4px #1a1e23, -2px -2px 4px #3e454d;
            --shadow-inset: inset 2px 2px 4px #1a1e23, inset -2px -2px 4px #3e454d;
        }

        /* Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--font-family);
            text-rendering: optimizeLegibility !important;
            -webkit-font-smoothing: antialiased !important;
        }

        /* Global SVG icon styling */
        svg {
            color: var(--text-color);
            width: 14px;
            height: 14px;
        }

        .d-none {
            display: none !important;
        }

        .d-block {
            display: block !important;
        }

        .d-flex {
            display: flex !important;
        }

        .bg-main {
            background-color: var(--bg-color);
        }

        /* Tooltip System */
        [data-tooltip] {
            position: relative;
            cursor: pointer;
            outline: none;
            display: inline-block;
        }

        /* Tooltip base styles */
        [data-tooltip]::after,
        [data-tooltip]::before {
            position: absolute;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
            z-index: 1000;
            /* Add small delay for smooth appearance */
            transition-delay: 0.2s;
        }

        /* Tooltip content */
        [data-tooltip]::after {
            content: attr(data-tooltip);
            background: var(--text-muted);
            color: #fff;
            padding: 4px 8px;
            border-radius: 6px;
            white-space: nowrap;
            font-size: 0.8rem;
            max-width: calc(100vw - 20px);
        }

        /* Tooltip arrow */
        [data-tooltip]::before {
            content: "";
            width: 0;
            height: 0;
            border-style: solid;
        }

        [data-tooltip][data-placement="bottom"]::after {
            top: calc(100% + 12px);
            left: 50%;
            transform: translateX(-50%);
        }

        [data-tooltip][data-placement="bottom"]::before {
            top: calc(100% + 6px);
            left: 50%;
            transform: translateX(-50%);
            border-width: 0 6px 6px 6px;
            border-color: transparent transparent var(--text-muted) transparent;
        }

        /* Top */
        [data-tooltip][data-placement="top"]::after {
            bottom: calc(100% + 12px);
            left: 50%;
            transform: translateX(-50%);
        }

        [data-tooltip][data-placement="top"]::before {
            bottom: calc(100% + 6px);
            left: 50%;
            transform: translateX(-50%);
            border-width: 6px 6px 0 6px;
            border-color: var(--text-muted) transparent transparent transparent;
        }

        /* Left */
        [data-tooltip][data-placement="left"]::after {
            right: calc(100% + 12px);
            top: 50%;
            transform: translateY(-50%);
        }

        [data-tooltip][data-placement="left"]::before {
            right: calc(100% + 6px);
            top: 50%;
            transform: translateY(-50%);
            border-width: 6px 0 6px 6px;
            border-color: transparent transparent transparent var(--text-muted);
        }

        /* Right */
        [data-tooltip][data-placement="right"]::after {
            left: calc(100% + 12px);
            top: 50%;
            transform: translateY(-50%);
        }

        [data-tooltip][data-placement="right"]::before {
            left: calc(100% + 6px);
            top: 50%;
            transform: translateY(-50%);
            border-width: 6px 6px 6px 0;
            border-color: transparent var(--text-muted) transparent transparent;
        }

        [data-tooltip]:hover::after,
        [data-tooltip]:hover::before,
        [data-tooltip]:focus-visible::after,
        [data-tooltip]:focus-visible::before,
        [role="tooltip"]:hover::after,
        [role="tooltip"]:hover::before,
        [role="tooltip"]:focus-visible::after,
        [role="tooltip"]:focus-visible::before {
            opacity: 1;
            z-index: 1500;
        }

        /* Scrollable container */
        .scrollable {
            overflow: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--text-muted) var(--bg-color);
        }

        .scrollable::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .scrollable::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 10px;
            box-shadow: var(--shadow-inset);
        }

        .scrollable::-webkit-scrollbar-thumb {
            background-color: var(--text-muted);
            border-radius: 10px;
            box-shadow: var(--shadow-soft);
            cursor: pointer;
        }

        .scrollable::-webkit-scrollbar-thumb:hover {
            background-color: var(--text-color);
        }

        /* Global Badge Styles */
        .badge {
            display: inline-block;
            padding: 0.25em 0.6em;
            font-size: 12px;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 0.25rem;
            color: #fff;
            margin-right: 0.5rem;
            position: relative;
            cursor: pointer;
        }

        .badge-primary {
            background-color: var(--primary-color);
        }

        .badge-secondary {
            background-color: var(--text-muted);
        }

        .badge-success {
            background-color: var(--success-color);
        }

        .badge-danger {
            background-color: var(--danger-color);
        }

        .badge-warning {
            background-color: var(--warning-color);
        }

        .badge-info {
            background-color: var(--info-color);
        }

        /* ========== CONSOLIDATED BUTTON SYSTEM ========== */
        
        /* Base button component - reusable across the app */
        .btn-base {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: var(--shadow-soft);
            cursor: pointer;
            position: relative;
            transition: var(--transition-speed);
        }

        .btn-base:hover {
            box-shadow: var(--shadow-inset);
        }

        /* Button size variants */
        .btn-xs { width: 20px; height: 20px; }
        .btn-sm { width: 24px; height: 24px; }
        .btn-md { width: 30px; height: 30px; }
        .btn-lg { width: 40px; height: 40px; }

        /* Icon sizing within buttons */
        .btn-xs svg { width: 12px; height: 12px; }
        .btn-sm svg { width: 14px; height: 14px; }
        .btn-md svg { width: 16px; height: 16px; }
        .btn-lg svg { width: 20px; height: 20px; }

        /* Brand logo specific sizing */
        .brand-logo { width: 40px; height: 40px; }

        /* ========== HEADER LAYOUT ========== */
        
        .page-header {
            height: var(--header-height);
            background-color: var(--bg-color);
            border-bottom: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 100;
        }



        /* ========== THEME TOGGLE COMPONENT ========== */
        
        .theme-toggle .icon-moon {
            display: none;
        }

        [data-theme="dark"] .theme-toggle .icon-sun {
            display: none;
        }

        [data-theme="dark"] .theme-toggle .icon-moon {
            display: block;
        }

        .theme-toggle:hover svg {
            transform: rotate(30deg);
            transition: transform var(--transition-speed) ease;
        }

        /* Ensure all SVG icons have consistent color */
        .btn-base svg {
            color: var(--text-color);
        }

        /* ========== SIDEBAR LAYOUT ========== */
        
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            position: fixed;
            top: var(--header-height);
            left: 0;
            background-color: var(--bg-color);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 0;
            z-index: 90;
        }

        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        /* ========== NAVIGATION BUTTON VARIANT ========== */
        
        .btn-nav {
            width: 50px;
            height: 48px;
        }

        .btn-nav svg {
            width: 20px;
            height: 20px;
        }

        /* Navigation specific states */
        .nav-item:hover {
            color: var(--accent-color);
        }

        .nav-item.active {
            color: var(--primary-color);
        }

        .nav-item:hover svg {
            transform: scale(1.1);
            transition: transform var(--transition-speed) ease;
        }

        /* Main Content Area */
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            min-height: calc(100vh - var(--header-height));
            transition: margin-left var(--transition-speed) ease;
        }

        /* ========== CONTENT SECTIONS ========== */
        
        .content-section {
            display: none;
            background-color: var(--bg-color);
        }

        .content-section.active {
            display: block;
        }

        /* ========== DASHBOARD LAYOUT ========== */
        
        .main-dashboard-layout {
            min-height: calc(100vh - var(--header-height));
            padding: 32px 24px 20px 24px;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-color);
        }

        .dashboard-columns {
            display: flex;
            gap: 20px;
            height: 100%;
        }

        .dashboard-col-left {
            flex: 2 1 0;
            display: flex;
            flex-direction: column;
            gap: 30px;
            min-width: 0;
            padding: 0 18px;
        }

        .dashboard-col-right {
            flex: 1 1 0;
            display: flex;
            flex-direction: column;
            gap: 30px;
            min-width: 320px;
            max-width: 420px;
            padding: 0 18px;
        }

        /* ========== UNIFIED CARD SYSTEM ========== */
        
        .card-base {
            background: var(--bg-color);
            border-radius: 6px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .card-horizontal {
            flex-direction: row;
            align-items: center;
            gap: 20px;
            padding: 10px 30px;
        }

        /* ========== BRAND CARD COMPONENT ========== */
        
        .brand-card {
            min-width: 320px;
            max-width: 100%;
        }

        .brand-logo {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(90deg, #42a5f5 0%, #6919d2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: var(--shadow-inset);
        }

        .brand-logo::before {
            content: attr(data-text);
            color: #fff;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 16px;
            letter-spacing: 1px;
        }

        .brand-title {
            background: linear-gradient(90deg, #1976d2, #e040fb, #1976d2);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            margin: 0;
        }

        /* ========== ATOMIC UTILITY CLASSES ========== */
        
        /* Layout Utilities */
        .grid-2x2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; }
        .grid-1x3 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 8px; }
        .grid-meta { display: flex; flex-direction: column; gap: 16px; }
        .grid-datetime { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 8px; }
        
        /* Flex Utilities */
        .flex-1 { flex: 1; }
        .flex-between { display: flex; align-items: center; justify-content: space-between; }
        .flex-center { display: flex; align-items: center; justify-content: center; }
        .flex-start { display: flex; align-items: flex-start; }
        .flex-gap-4 { display: flex; align-items: center; gap: 4px; }
        .flex-gap-8 { display: flex; align-items: center; gap: 8px; }
        .flex-gap-10 { display: flex; align-items: center; gap: 10px; }
        .flex-gap-12 { display: flex; align-items: center; gap: 12px; }
        .flex-gap-15 { display: flex; align-items: center; gap: 15px; }
        .gap-6 { gap: 6px; }
        .gap-8 { gap: 8px; }
        .gap-10 { gap: 10px; }
        .flex-column { display: flex; flex-direction: column; }
        .flex-column-start { display: flex; flex-direction: column; align-items: flex-start; }
        .flex-wrap { display: flex; flex-wrap: wrap; }
        .flex-between-end { display: flex; align-items: flex-end; justify-content: space-between; }
        
        /* Text Utilities */
        .text-title { font-size: 16px; font-weight: 600; color: var(--text-color); text-transform: uppercase; margin: 0; }
        .text-title-sm { font-size: 14px; font-weight: 600; color: var(--primary-color); text-transform: uppercase; margin: 0; }
        .text-stat { font-size: 18px; font-weight: 600; color: var(--text-color); visibility: hidden; }
        .text-value { font-weight: 600; color: var(--text-color); font-size: 12px; }
        .text-info-label { font-size: 12px; color: var(--text-muted); font-weight: 600; text-transform: uppercase; }
        .text-info-value { font-size: 14px; color: var(--text-color); }
        .text-ellipsis { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .text-muted { color: var(--text-muted); }
        .text-label { font-size: 12px; font-weight: 600; color: var(--text-muted); }
        .text-uppercase { text-transform: uppercase; }
        .text-center { text-align: center; }
        .text-xs { font-size: 12px; }
        .text-sm { font-size: 14px; }
        .font-normal { font-weight: 400; }
        .font-semibold { font-weight: 600; }
        
        /* Spacing Utilities */
        .p-0 { padding: 0; }
        .p-10 { padding: 0 10px; }
        .p-12 { padding: 12px; }
        .p-15 { padding: 15px; }
        .px-10 { padding-left: 10px; padding-right: 10px; }
        .px-12 { padding-left: 12px; padding-right: 12px; }
        .px-15 { padding-left: 15px; padding-right: 15px; }
        .px-18 { padding-left: 18px; padding-right: 18px; }
        .px-28 { padding-left: 28px; padding-right: 28px; }
        .py-8 { padding-top: 8px; padding-bottom: 8px; }
        .py-12 { padding-top: 12px; padding-bottom: 12px; }
        .py-14 { padding-top: 14px; padding-bottom: 14px; }
        .p-4 { padding: 4px; }
        .p-5 { padding: 5px; }
        .p-8 { padding: 8px; }
        .pt-5 { padding-top: 5px; }
        .pt-10 { padding-top: 10px; }
        .pb-5 { padding-bottom: 5px; }
        .pb-25 { padding-bottom: 25px; }
        .m-0 { margin: 0; }
        .mb-5 { margin-bottom: 5px; }
        .mb-6 { margin-bottom: 6px; }
        .mb-8 { margin-bottom: 8px; }
        .mb-10 { margin-bottom: 10px; }
        .mb-15 { margin-bottom: 15px; }
        .mb-20 { margin-bottom: 20px; }
        .mb-25 { margin-bottom: 25px; }
        .mt-8 { margin-top: 8px; }
        .m-auto { margin: auto; }
        .my-5p { margin-top: 5%; margin-bottom: 5%; }
        .ml-12 { margin-left: 12px; }
        .ml-15 { margin-left: 15px; }
        .mr-10 { margin-right: 10px; }
        .mr-12 { margin-right: 12px; }
        .mr-15 { margin-right: 15px; }
        .mx-10 { margin-left: 10px; margin-right: 10px; }
        
        /* Display Utilities */
        .d-block { display: block; }
        .d-none { display: none; }
        .d-flex { display: flex; }
        .inline-flex { display: inline-flex; }
        .block { display: block; }
        
        /* Grid Utilities */
        .grid-3-col { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        .grid-1-col { display: grid; grid-template-columns: 1fr; gap: 15px; }
        
        /* Size Utilities */
        .w-5 { width: 5px; }
        .w-12 { width: 12px; }
        .w-14 { width: 14px; }
        .w-16 { width: 16px; }
        .w-24 { width: 24px; }
        .w-30 { width: 30px; }
        .w-32 { width: 32px; }
        .w-40 { width: 40px; }
        .w-auto { width: auto; }
        .w-full { width: 100%; }
        .w-4-5 { width: 80%; }
        .h-12 { height: 12px; }
        .h-14 { height: 14px; }
        .h-16 { height: 16px; }
        .h-24 { height: 24px; }
        .h-30 { height: 30px; }
        .h-32 { height: 32px; }
        .h-38 { height: 38px; }
        .h-40 { height: 40px; }
        .h-60 { height: 60px; }
        .h-auto { height: auto; }
        .h-full { height: 100%; }
        .h-screen { height: 100vh; }
        .h-300 { height: 300px; }
        .min-w-70 { min-width: 70px; }
        .min-w-120 { min-width: 120px; }
        .min-w-180 { min-width: 180px; }
        .min-w-320 { min-width: 320px; }
        .min-w-420 { min-width: 420px; }
        .max-w-420 { max-width: 420px; }
        .max-w-1000 { max-width: 1000px; }
        .max-w-full { max-width: 100%; }
        .max-h-80vh { max-height: 80vh; }
        .max-h-70vh { max-height: 70vh; }
        .max-h-full { max-height: 100%; }
        .min-h-300 { min-height: 300px; }
        
        /* Z-Index Utilities */
        .z-1 { z-index: 1; }
        .z-2 { z-index: 2; }
        .z-10 { z-index: 10; }
        .z-20 { z-index: 20; }
        .z-50 { z-index: 50; }
        .z-100 { z-index: 100; }
        .z-200 { z-index: 200; }
        .z-1000 { z-index: 1000; }
        .z-2000 { z-index: 2000; }
        
        /* Annotation tools display fix */
        #annotationTools[style*="flex"] {
            display: flex !important;
        }
        
        #annotationTools {
            pointer-events: auto;
        }
        
        #annotationTools.d-none {
            display: none !important;
        }
        
        /* Loading container center fix */
        #loadingContainer {
            text-align: center;
        }
        
        /* Border Utilities */
        .border-base { border: 1px solid var(--border-color); }
        .border-r { border-right: 1px solid var(--border-color); }
        .border-t { border-top: 1px solid var(--border-color); }
        .border-none { border: none; }
        .rounded-md { border-radius: 6px; }
        .rounded-lg { border-radius: 8px; }
        .rounded-sm { border-radius: 4px; }
        .rounded-full { border-radius: 50%; }
        .rounded-t { border-radius: 4px 4px 0 0; }
        .rounded-t-lg { border-radius: 8px 8px 0 0; }
        
        /* Position Utilities */
        .relative { position: relative; }
        .absolute { position: absolute; }
        .fixed { position: fixed; }
        .static { position: static; }
        .sticky-header { position: sticky; top: 0; z-index: 10; }
        
        /* Positioning Values */
        .bottom-2 { bottom: 2px; }
        .bottom-8 { bottom: 32px; }
        .bottom-20 { bottom: 20px; }
        .left-0 { left: 0; }
        .left-1-2 { left: 50%; }
        .top-0 { top: 0; }
        .inset-0 { top: 0; left: 0; right: 0; bottom: 0; }
        .transform-center-x { transform: translateX(-50%); }
        
        /* Pointer Events */
        .pointer-events-none { pointer-events: none; }
        .pointer-events-auto { pointer-events: auto; }
        
        /* Log Item Utilities */
        .log-card { 
            margin-bottom: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
        }
        .log-header { 
            display: flex;
            align-items: center;
            background-color: var(--bg-color);
            height: 38px;
        }
        .status-bar { width: 5px; height: 100%; }
        .status-bar[log-status="pass"] { background-color: var(--success-color); }
        .status-bar[log-status="fail"] { background-color: var(--danger-color); }
        .status-bar[log-status="skip"] { background-color: var(--warning-color); }
        .status-bar[log-status="info"] { background-color: var(--info-color); }
        
        .log-id { 
            font-size: 12px;
            border-right: 1px solid var(--border-color);
            padding: 0 15px;
            font-weight: 600;
            height: 100%;
            color: var(--text-color);
            text-transform: uppercase;
            display: flex;
            align-items: center;
            white-space: nowrap;
        }
        .log-name { 
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: var(--text-color);
            margin: 0 12px;
            flex-grow: 1;
        }
        .log-time { 
            font-size: 12px;
            color: var(--text-muted);
            white-space: nowrap;
            margin-right: 15px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .log-time svg { width: 12px; height: 12px; }
        .log-actions { display: flex; gap: 10px; margin-right: 12px; }
        
        /* Expandable Content */
        .expandable-content {
            padding: 0;
            border-top: 1px solid var(--border-color);
            max-height: 0;
            overflow: hidden;
            color: var(--text-color);
            font-size: 14px;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            will-change: max-height;
        }
        .log-item.active .expandable-content {
            max-height: 200px;
            padding: 15px;
        }
        .log-content-grid {
            display: flex;
            align-items: center;
            width: 100%;
        }
        .log-time-col {
            font-size: 12px;
            color: var(--text-muted);
            margin-right: 15px;
            min-width: 60px;
        }
        .log-message-col {
            flex-grow: 1;
            color: var(--text-color);
        }
        .log-message-col p { margin: 0; }
        .overflow-hidden { overflow: hidden; }
        .min-w-60 { min-width: 60px; }
        .w-full { width: 100%; }
        .cursor-pointer { cursor: pointer; }
        
        /* Interactive States */
        .transition-smooth { transition: all 0.3s ease; }
        .transition-fast { transition: all 0.15s ease; }
        .transition-transform { transition: transform var(--transition-speed) ease; }
        .transition-bg { transition: background-color 0.2s; }
        .hover-shadow:hover { box-shadow: var(--shadow-inset); }
        .hover-lift:hover { transform: translateY(-2px); }
        .hover-scale:hover { transform: scale(1.1); }
        .hover-rotate:hover { transform: rotate(30deg); }
        .hover-bg-muted:hover { background-color: var(--text-muted); opacity: 0.1; }
        
        /* Remove focus outline from all interactive elements */
        button:focus,
        input:focus,
        select:focus,
        textarea:focus,
        .color-option:focus,
        .shape-btn:focus {
            outline: none;
            box-shadow: none;
        }
        
        /* Cursor Utilities */
        .cursor-pointer { cursor: pointer; }
        .cursor-grab { cursor: grab; }
        .cursor-grabbing { cursor: grabbing !important; }
        .cursor-not-allowed { cursor: not-allowed; }
        .cursor-default { cursor: default; }
        
        /* Overflow Utilities */
        .overflow-auto { overflow: auto; }
        .overflow-hidden { overflow: hidden; }
        
        /* Object Fit Utilities */
        .object-contain { object-fit: contain; }
        
        /* Backdrop Filter */
        .backdrop-blur-sm { backdrop-filter: blur(2px); }
        
        /* Border & Shadow Utilities */
        .border-b { border-bottom: 1px solid var(--border-color); }
        .rounded-sm { border-radius: 4px; }
        .shadow-soft { box-shadow: var(--shadow-soft); }
        .shadow-toast { box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15); }
        .shadow-inset { box-shadow: var(--shadow-inset); }
        .hover-shadow-inset:hover { box-shadow: var(--shadow-inset); }
        .active-shadow-inset:active { box-shadow: var(--shadow-inset); }
        .active-shadow-inset.active { box-shadow: var(--shadow-inset); }
        
        /* Alignment Utilities */
        .items-center { align-items: center; }
        .items-end { align-items: flex-end; }
        .justify-center { justify-content: center; }
        .justify-start { justify-content: flex-start; }
        .justify-end { justify-content: flex-end; }
        .justify-between { justify-content: space-between; }
        
        /* Typography Utilities */
        .letter-tight { letter-spacing: -2px; }
        
        /* Color Utilities */
        .bg-red { background-color: #FF0000; }
        .bg-green { background-color: #00FF00; }
        .bg-blue { background-color: #0000FF; }
        .bg-yellow { background-color: #e6e612; }
        .bg-magenta { background-color: #FF00FF; }
        
        /* Toast Semantic Colors */
        .bg-success { background-color: #d4edda; }
        .bg-danger { background-color: #f8d7da; }
        .bg-warning { background-color: #fff3cd; }
        .bg-info { background-color: #d1ecf1; }
        
        .text-success { color: #155724; }
        .text-danger { color: #721c24; }
        .text-warning { color: #856404; }
        .text-info { color: #0c5460; }
        
        /* Modal & Interactive Colors */
        .bg-black-60 { background-color: rgba(0, 0, 0, 0.6); }
        .bg-black-10 { background-color: rgba(0, 0, 0, 0.1); }
        .bg-white { background-color: white; }
        .overlay { 
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
        }
        
        /* Opacity Utilities */
        .opacity-0 { opacity: 0; }
        .opacity-50 { opacity: 0.5; }
        
        /* Composite Utilities (Common Combinations) */
        .status-body { padding: 0 15px; margin-bottom: 25px; }
        .header-spacing { margin-bottom: 8px; }
        .icon-muted { color: var(--text-muted); }
        
        /* Glass Effect Utilities */
        .glass-header { 
            padding: 10px; 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px); 
            border-bottom: 1px solid rgba(255, 255, 255, 0.2); 
        }
        
        .glass-header-status {
            padding: 10px; 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px); 
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px 4px 0 0;
            margin-bottom: 25px;
            z-index: 2;
        }
        
        /* Icon Box Utilities */
        .icon-box {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            border-radius: 6px;
            width: 28px;
            height: 28px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .icon-box-sm {
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            width: 24px;
            height: 24px;
            padding: 5px;
        }
        
        /* Card Utilities */
        .card-padding { padding: 10px; }
        .card-content { flex: 1; padding-bottom: 40px; }
        
        /* Search Components */
        .search-container {
            display: flex;
            align-items: center;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-color);
            box-shadow: var(--shadow-soft);
            overflow: hidden;
            min-width: 0;
        }
        
        .search-input {
            flex-grow: 1;
            border: none;
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 6px;
            box-shadow: var(--shadow-inset);
            border-radius: 8px 0 0 8px;
            min-width: 0;
        }
        
        .search-input:focus { outline: none; }
        
        .search-btn {
            border: none;
            border-left: 1px solid var(--border-color);
            border-radius: 0 8px 8px 0;
        }
        
        /* ========== TEST COMPONENT ATOMIC CLASSES ========== */
        
        /* ID Badge Component */
        .id-badge {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-shadow: var(--shadow-soft);
            min-width: 60px;
            position: relative;
            display: flex;
            flex-direction: column;
            padding: 25px 5px 8px 5px;
            flex-shrink: 0;
        }
        
        .id-label {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 600;
            border-bottom: 1px solid var(--border-color);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 2px 5px;
            z-index: 1;
            text-align: left;
        }
        
        .id-value {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-color);
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Test Info Container */
        .test-info-container {
            flex: 1;
            overflow: hidden;
            margin: 0 10px;
        }
        
        /* Test Metadata Components */
        .test-meta {
            font-size: 12px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* Test Card Interactive */
        .test-card-interactive {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .test-card-interactive:hover {
            box-shadow: var(--shadow-inset);
            transform: translateY(-1px);
        }
        
        /* Status-based Hover Effects */
        .test-card-interactive[test-status="pass"]:hover {
            background: rgba(var(--success-color-rgb), 0.05);
        }
        
        .test-card-interactive[test-status="fail"]:hover {
            background: rgba(var(--danger-color-rgb), 0.05);
        }
        
        .test-card-interactive[test-status="skip"]:hover {
            background: rgba(var(--warning-color-rgb), 0.05);
        }
        
        /* Active States */
        .test-card-interactive[aria-selected="true"][test-status="pass"] {
            background: rgba(var(--success-color-rgb), 0.1);
            box-shadow: var(--shadow-inset);
        }
        
        .test-card-interactive[aria-selected="true"][test-status="fail"] {
            background: rgba(var(--danger-color-rgb), 0.1);
            box-shadow: var(--shadow-inset);
        }
        
        .test-card-interactive[aria-selected="true"][test-status="skip"] {
            background: rgba(var(--warning-color-rgb), 0.1);
            box-shadow: var(--shadow-inset);
        }
        .card-progress { 
            height: 8px; 
            margin: 0 15px 15px 15px; 
            border-radius: 3px; 
            box-shadow: var(--shadow-inset); 
            position: relative; 
        }
        
        /* ========== DATA-DRIVEN COMPONENTS ========== */
        
        /* Universal Card System */
        .card-universal {
            border-radius: 6px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--border-color);
            background: var(--bg-color);
            position: relative;
            overflow: hidden;
        }
        
        /* Status Card Themes (Data-Driven) */
        [data-status="pass"] { background: linear-gradient(135deg, rgba(67, 233, 122, 0.20) 0%, rgba(56, 249, 215, 0.20) 100%); }
        [data-status="fail"] { background: linear-gradient(135deg, rgba(255, 95, 109, 0.20) 0%, rgba(255, 195, 113, 0.20) 100%); }
        [data-status="skip"] { background: linear-gradient(135deg, rgba(247, 151, 30, 0.20) 0%, rgba(255, 210, 0, 0.20) 100%); }
        [data-status="total"] { background: linear-gradient(135deg, rgba(33, 150, 243, 0.20) 0%, rgba(156, 39, 176, 0.20) 100%); }
        
        /* Progress Bar Data-Driven Styling */
        .card-progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: var(--progress, 0%);
            border-radius: 3px;
            transition: width 0.4s;
        }
        
        [data-status="pass"] .card-progress::after { background: linear-gradient(90deg, rgba(67, 233, 123, 0.5) 0%, rgba(56, 249, 215, 0.5) 100%); }
        [data-status="fail"] .card-progress::after { background: linear-gradient(90deg, rgba(255, 88, 88, 0.5) 0%, rgba(240, 152, 25, 0.5) 100%); }
        [data-status="skip"] .card-progress::after { background: linear-gradient(90deg, rgba(247, 151, 30, 0.5) 0%, rgba(255, 210, 0, 0.5) 100%); }
        [data-status="total"] .card-progress::after { background: linear-gradient(90deg, rgba(33, 150, 243, 0.5) 0%, rgba(33, 203, 243, 0.5) 100%); }

        /* ========== CONSOLIDATED CARD COMPONENTS ========== */
        
        /* Chart Cards - Using Utilities */
        .chart-card {
            min-height: 180px;
        }
        
        .chart-content canvas {
            width: 100% !important;
            height: 100% !important;
            max-width: 100%;
            max-height: 100%;
            display: block;
            margin: 0 auto;
            background: transparent;
        }















        /* Make the last chart span 2 columns if it's alone in the last row */
        .grid-1x3 article:only-child,
        .grid-1x3 article:last-child:nth-child(odd):nth-last-child(1) {
            grid-column: 1 / -1;
        }



        /* Chart Content Specific Styles */
        .chart-content {
            height: 320px;
            min-height: 220px;
            overflow: visible;
        }

        .chart-content::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .chart-content::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 10px;
            box-shadow: var(--shadow-inset);
        }

        .chart-content::-webkit-scrollbar-thumb {
            background-color: var(--text-muted);
            border-radius: 10px;
            box-shadow: var(--shadow-soft);
            cursor: pointer;
        }

        .chart-content::-webkit-scrollbar-thumb:hover {
            background-color: var(--text-color);
        }



        /* UI Testing Layout Styles */
        .ui-testing-layout {
            height: calc(100vh - var(--header-height));
            display: flex;
        }

        /* Test List Column */
        .ui-testing-col-left {
            width: 33.333%;
            height: 100%;
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .ui-testing-col-left .icon-box {
            width: 30px;
            height: 30px;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-shadow: var(--shadow-soft);
        }

        .test-list-container {
            flex-grow: 1;
            overflow-y: auto;
            height: 100%;
        }


        .status-badge {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            padding: 4px 10px;
            border-radius: 20px;
            color: white;
            box-shadow: var(--shadow-soft);
            border: solid 1px var(--border-color);
        }

        .status-badge[test-status="pass"] {
            background-color: var(--success-color);
        }

        .status-badge[test-status="fail"] {
            background-color: var(--danger-color);
        }

        .status-badge[test-status="skip"] {
            background-color: var(--warning-color);
        }

        .status-badge[test-status="info"] {
            background-color: var(--primary-color);
        }

        /* Filter Container */
        .dropdown-container {
            position: relative;
        }

        .dropdown-button {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-shadow: var(--shadow-soft);
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 5px;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-shadow: var(--shadow-soft);
            min-width: 70px;
            z-index: 200;
            display: none;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-option {
            font-size: 12px;
            padding: 2px 8px;
            margin: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            border-radius: 12px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            gap: 5px;
        }

        .dropdown-option:hover,
        .dropdown-button:hover {
            box-shadow: var(--shadow-inset);
        }

        .dropdown-option.active {
            background-color: rgba(var(--primary-color-rgb), 0.1);
            box-shadow: var(--shadow-inset);
        }

        .dropdown-option-indicator,
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 5px;
        }

        .dropdown-option-indicator[test-status="all"],
        .dropdown-option-indicator[log-status="all"],
        .status-indicator[test-status="all"],
        .status-indicator[log-status="all"] {
            background: linear-gradient(45deg, var(--success-color) 0%, var(--danger-color) 50%, var(--warning-color) 100%);
        }

        .dropdown-option-indicator[test-status="pass"],
        .dropdown-option-indicator[log-status="pass"],
        .status-indicator[test-status="pass"],
        .status-indicator[log-status="pass"] {
            background-color: var(--success-color);
        }

        .dropdown-option-indicator[test-status="fail"],
        .dropdown-option-indicator[log-status="fail"],
        .status-indicator[test-status="fail"],
        .status-indicator[log-status="fail"] {
            background-color: var(--danger-color);
        }

        .dropdown-option-indicator[test-status="skip"],
        .dropdown-option-indicator[log-status="skip"],
        .status-indicator[test-status="skip"],
        .status-indicator[log-status="skip"] {
            background-color: var(--warning-color);
        }

        .dropdown-option-indicator[log-status="info"],
        .status-indicator[log-status="info"] {
            background-color: var(--info-color);
        }

        /* Filter Badge */
        .dropdown-badge {
            position: absolute;
            top: -10px;
            right: -8px;
            min-width: 28px;
            height: 14px;
            border-radius: 10px;
            line-height: 10px;
            background-color: var(--text-muted);
            color: white;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
        }

        .dropdown-badge[test-status="all"],
        .dropdown-badge[log-status="all"] {
            background-color: var(--text-muted);
        }

        .dropdown-badge[test-status="pass"],
        .dropdown-badge[log-status="pass"] {
            background-color: var(--success-color);
        }

        .dropdown-badge[test-status="fail"],
        .dropdown-badge[log-status="fail"] {
            background-color: var(--danger-color);
        }

        .dropdown-badge[test-status="skip"],
        .dropdown-badge[log-status="skip"] {
            background-color: var(--warning-color);
        }

        .dropdown-badge[log-status="info"] {
            background-color: var(--info-color);
        }

        /* No Data Container */
        .message-container {
            display: flex;
            justify-content: center;
            align-items: center;
            align-items: center;
            background-color: rgba(var(--secondary-color-rgb), 0.1);
            border-radius: 12px;
            margin: 15px;
            height: 90%;
        }

        .message-container .message-box {
            text-align: center;
            color: var(--text-muted);
            padding: 20px;
        }

        .message-container .kaomoji {
            font-size: 1.2rem;
            margin: 10px;
            color: var(--text-muted);
            white-space: nowrap;
        }

        /* Test Details Column */
        .ui-testing-col-right {
            width: 66.667%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .test-details-header {
            height: 60px;
            padding: 8px 25px 8px 25px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: var(--bg-color);
        }

        .test-details-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: var(--shadow-soft);
        }

        .test-details-title {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-muted);
            flex-grow: 1;
        }

        .export-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: var(--shadow-soft);
            color: var(--text-color);
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }

        .export-button:hover {
            box-shadow: var(--shadow-inset);
        }

        .test-details-content {
            display: flex;
            flex-direction: column;
            height: calc(100vh - var(--header-height) - 60px);
            overflow: hidden;
        }

        .test-info-section {
            padding: 10px 10px 5px 10px;
        }

        .test-info-section .card {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: var(--shadow-soft);
            margin-bottom: 10px;
        }

        .test-info-section .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .test-info-section .card-header-title,
        .test-info-section .card-header-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-info-section .card-header-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: var(--shadow-soft);
        }

        .test-info-section .card-header-title h3 {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-color);
            margin: 0;
        }

        .test-info-section .card-content {
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            will-change: max-height;
            max-height: none;
        }

        .test-info-section .card-content.collapsed {
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
        }

        .test-info-section .card-content.expanding {
            max-height: 1000px;
            /* Large enough to accommodate content */
        }



        .tag-1 {
            background-color: #5c5cdec3;
        }

        .tag-2 {
            background-color: #8944d8c3;
        }

        .tag-3 {
            background-color: #0e6f8ac3;
        }

        .tag-4 {
            background-color: #c82b8fc3;
        }

        .tag-5 {
            background-color: #7a7410c3;
        }

        .test-logs-panel {
            height: 100%;
        }

        /* Test Log Atomic System - 90% Reduction! */





        .log-toggle svg {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
        }
        .log-item.active .log-toggle svg {
            transform: rotate(180deg);
        }
        
        /* Accordion icon rotation for test-info section */
        #test-info-accordion-icon {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
        }



        /* Toast Container - Optimized with Atomic Classes */

        /* Toast Message - Using Atomic Classes where possible */
        .toast-message {
            /* Animation and transition effects that can't be atomized */
            opacity: 0;
            animation: toast-in 0.3s forwards, toast-out 0.3s 2.7s forwards;
            transition: opacity 0.5s;
        }

        /* Toast variants now use atomic classes: .bg-success .text-success, etc. */

        @keyframes toast-in {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes toast-out {
            to {
                opacity: 0;
                transform: translateY(30px);
            }
        }

        /* Media Modal - Optimized with Atomic Classes */

        .media-container {
            cursor: default;
        }

        .media-container[style*="grab"] {
            cursor: grab;
        }

        /* Modal content animation preserved */
        .modal-fade-in {
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Modal header, title, icon, and close button now use atomic classes */

        /* Media body, container, content, and footer now use atomic classes */

        /* Media controls and buttons now use atomic classes */


        /* Draggable functionality - preserved for specific cursor behaviors */
        .draggable {
            cursor: grab;
        }

        .dragging {
            cursor: grabbing !important;
        }

        /* Loading and other utility classes now use atomic equivalents */

        /* Annotation canvas */
        #annotationCanvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="%237b8ca0"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM21.41 6.34l-3.75-3.75-2.53 2.54 3.75 3.75 2.53-2.54z"/></svg>') 0 24, auto;
            width: 100%;
            height: 100%;
            pointer-events: none;
            color: var(--text-muted);
        }

        /* Annotation tools now use atomic classes */

        /* Shape buttons and color options now use atomic classes */



        /* Zoom wrapper and download loading now use atomic classes */
        .media-zoom-wrapper {
            transition: transform 0.2s;
            will-change: transform;
        }
        
        .download-loading {
            min-height: 32px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body data-theme="light">

    <!-- Header -->
    <header class="page-header" role="banner">
        <div class="flex-gap-12">
            <div class="brand-icon btn-base btn-lg" data-tooltip="Vision Report" data-placement="right" role="img" aria-label="Vision Report Logo">
                <svg width="56" height="56" viewBox="40 50 160 120" class="d-block">
                    <defs>
                        <linearGradient id="auroraGradientAnimated" x1="60" y1="70" x2="180" y2="150"
                            gradientUnits="userSpaceOnUse">
                            <stop offset="0%" stop-color="#6D5BFF">
                                <animate attributeName="stop-color" values="#6D5BFF;#00E0FF;#00FFA3;#6D5BFF" dur="3s"
                                    repeatCount="indefinite" />
                            </stop>
                            <stop offset="50%" stop-color="#00E0FF">
                                <animate attributeName="stop-color" values="#00E0FF;#00FFA3;#FF6DCB;#00E0FF" dur="3s"
                                    repeatCount="indefinite" />
                            </stop>
                            <stop offset="100%" stop-color="#00FFA3">
                                <animate attributeName="stop-color" values="#00FFA3;#FF6DCB;#6D5BFF;#00FFA3" dur="3s"
                                    repeatCount="indefinite" />
                            </stop>
                        </linearGradient>
                        <filter id="wingShadow" x="-20%" y="-20%" width="140%" height="140%">
                            <feDropShadow dx="0" dy="4" stdDeviation="4" flood-color="#6D5BFF" flood-opacity="0.25" />
                        </filter>
                        <linearGradient id="vrTextGradient" x1="0" y1="0" x2="1" y2="1">
                            <stop offset="0%" stop-color="#6D5BFF" />
                            <stop offset="100%" stop-color="#00FFA3" />
                        </linearGradient>
                    </defs>
                    <path d="M50 65 Q120 210 190 65 Q165 105 120 160 Q75 105 50 65 Z"
                        fill="url(#auroraGradientAnimated)" filter="url(#wingShadow)" opacity="0.95" />

                    <text id="r-logo" x="120" y="120" text-anchor="middle" font-family="Montserrat, Arial, sans-serif"
                        font-size="60" font-weight="900" fill="url(#vrTextGradient)" opacity="0"
                        class="letter-tight">
                        R
                    </text>
                </svg>
            </div>
        </div>
        <nav class="flex-gap-12" role="navigation" aria-label="Header actions">
            <button type="button" class="btn-base btn-lg" data-tooltip="Reload" data-placement="bottom" aria-label="Reload page">
                <svg aria-hidden="true">
                    <use href="#icon-reload"></use>
                </svg>
            </button>
            <button type="button" id="themeToggle" class="btn-base btn-lg theme-toggle" data-tooltip="Toggle Theme" data-placement="bottom" aria-label="Toggle dark mode" aria-pressed="false">
                <svg class="icon-sun" aria-hidden="true">
                    <use href="#icon-sun"></use>
                </svg>
                <svg class="icon-moon" aria-hidden="true">
                    <use href="#icon-moon"></use>
                </svg>
            </button>
        </nav>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar-nav" role="navigation" aria-label="Main navigation">
        <nav class="nav-menu">
            <button id="nav-dashboard" class="nav-item btn-base btn-nav active" data-section="dashboard" data-tooltip="Dashboard" data-placement="right" role="tab" aria-selected="true" aria-controls="dashboard">
                <svg aria-hidden="true"><use href="#icon-dashboard"></use></svg>
            </button>
            <button id="nav-ui-testing" class="nav-item btn-base btn-nav" data-section="ui-testing" data-tooltip="UI Testing" data-placement="right" role="tab" aria-selected="false" aria-controls="ui-testing">
                <svg aria-hidden="true"><use href="#icon-ui-testing"></use></svg>
            </button>
            <button id="nav-api-testing" class="nav-item btn-base btn-nav" data-section="api-testing" data-tooltip="API Testing" data-placement="right" role="tab" aria-selected="false" aria-controls="api-testing">
                <svg aria-hidden="true"><use href="#icon-api-testing"></use></svg>
            </button>
            <button id="nav-pdf-compare" class="nav-item btn-base btn-nav" data-section="pdf-compare" data-tooltip="PDF Compare" data-placement="right" role="tab" aria-selected="false" aria-controls="pdf-compare">
                <svg aria-hidden="true"><use href="#icon-pdf-compare"></use></svg>
            </button>
            <button id="nav-xml-compare" class="nav-item btn-base btn-nav" data-section="xml-compare" data-tooltip="XML Compare" data-placement="right" role="tab" aria-selected="false" aria-controls="xml-compare">
                <svg aria-hidden="true"><use href="#icon-xml-compare"></use></svg>
            </button>
            <button id="nav-json-compare" class="nav-item btn-base btn-nav" data-section="json-compare" data-tooltip="JSON Compare" data-placement="right" role="tab" aria-selected="false" aria-controls="json-compare">
                <svg aria-hidden="true"><use href="#icon-json-compare"></use></svg>
            </button>
        </nav>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
        <section id="dashboard" class="content-section active" role="tabpanel" aria-labelledby="nav-dashboard" tabindex="0">
            <div class="main-dashboard-layout">
                <div class="dashboard-columns">
                    <div class="dashboard-col-left">
                        <div class="card-base card-horizontal brand-card">
                            <div class="brand-logo" data-text="B2B" aria-label="B2B Application"></div>
                            <h1 class="brand-title">Vision Test Report</h1>
                        </div>
                        <div class="grid-2x2">
                            <article class="card-universal flex-column" data-status="pass" data-count="20" data-percentage="40">
                                <header class="glass-header flex-between">
                                    <h3 class="text-title">Pass</h3>
                                    <div class="flex-gap-8">
                                        <button class="btn-base btn-sm flex-center status-view-btn" type="button" data-tooltip="View Passed Tests" data-placement="bottom" aria-label="View passed tests in UI Testing">
                                            <svg aria-hidden="true"><use href="#icon-eye"></use></svg>
                                        </button>
                                        <div class="icon-box flex-center">
                                            <svg aria-hidden="true"><use href="#icon-status-pass"></use></svg>
                                        </div>
                                    </div>
                                </header>
                                <div class="flex-between status-body">
                                    <span class="text-stat" id="statusPassNumber" data-pass-number="20">20</span>
                                    <span class="text-stat" id="statusPassPercentage" data-pass-percentage="40">40%</span>
                                </div>
                                <div class="card-progress" id="statusPassProgress" data-progress="40"></div>
                            </article>
                            <article class="card-universal flex-column" data-status="fail" data-count="10" data-percentage="20">
                                <header class="glass-header flex-between">
                                    <h3 class="text-title">Fail</h3>
                                    <div class="flex-gap-8">
                                        <button class="btn-base btn-sm flex-center status-view-btn" type="button" data-tooltip="View Failed Tests" data-placement="bottom" aria-label="View failed tests in UI Testing">
                                            <svg aria-hidden="true"><use href="#icon-eye"></use></svg>
                                        </button>
                                        <div class="icon-box flex-center">
                                            <svg aria-hidden="true"><use href="#icon-status-fail"></use></svg>
                                        </div>
                                    </div>
                                </header>
                                <div class="flex-between status-body">
                                    <span class="text-stat" id="statusFailNumber" data-fail-number="10">10</span>
                                    <span class="text-stat" id="statusFailPercentage" data-fail-percentage="20">20%</span>
                                </div>
                                <div class="card-progress" id="statusFailProgress" data-progress="20"></div>
                            </article>
                            <article class="card-universal flex-column" data-status="skip" data-count="10" data-percentage="20">
                                <header class="glass-header flex-between">
                                    <h3 class="text-title">Skip</h3>
                                    <div class="flex-gap-8">
                                        <button class="btn-base btn-sm flex-center status-view-btn" type="button" data-tooltip="View Skipped Tests" data-placement="bottom" aria-label="View skipped tests in UI Testing">
                                            <svg aria-hidden="true"><use href="#icon-eye"></use></svg>
                                        </button>
                                        <div class="icon-box flex-center">
                                            <svg aria-hidden="true"><use href="#icon-status-skip"></use></svg>
                                        </div>
                                    </div>
                                </header>
                                <div class="flex-between status-body">
                                    <span class="text-stat" id="statusSkipNumber" data-skip-number="10">10</span>
                                    <span class="text-stat" id="statusSkipPercentage" data-skip-percentage="20">20%</span>
                                </div>
                                <div class="card-progress" id="statusSkipProgress" data-progress="20"></div>
                            </article>
                            <article class="card-universal flex-column" data-status="total" data-count="40" data-percentage="100">
                                <header class="glass-header flex-between">
                                    <h3 class="text-title">Total</h3>
                                    <div class="flex-gap-8">
                                        <button class="btn-base btn-sm flex-center status-view-btn" type="button" data-tooltip="View All Tests" data-placement="bottom" aria-label="View all tests in UI Testing">
                                            <svg aria-hidden="true"><use href="#icon-eye"></use></svg>
                                        </button>
                                        <div class="icon-box flex-center">
                                            <svg aria-hidden="true"><use href="#icon-status-total"></use></svg>
                                        </div>
                                    </div>
                                </header>
                                <div class="flex-between status-body">
                                    <span class="text-stat" id="statusTotalNumber" data-total-number="40">40</span>
                                    <span class="text-stat" id="statusTotalPercentage" data-total-percentage="100">100%</span>
                                </div>
                                <div class="card-progress" id="statusTotalProgress" data-progress="100"></div>
                            </article>
                        </div>
                        <div class="grid-1x3">
                            <article class="card-universal flex-column card-padding chart-card">
                                <header class="flex-between header-spacing">
                                    <h3 class="text-title-sm">Test Status Summary</h3>
                                    <div class="flex-gap-8">
                                        <button class="btn-base btn-sm flex-center chart-download-btn" type="button" data-tooltip="Download Chart" data-placement="bottom">
                                            <svg aria-hidden="true"><use href="#icon-export"></use></svg>
                                        </button>
                                        <div class="icon-box-sm flex-center">
                                            <svg aria-hidden="true"><use href="#icon-chart-pie"></use></svg>
                                        </div>
                                    </div>
                                </header>
                                <div class="card-content" id="test-status-summary-chart">
                                    <canvas id="chartStatusSummary"></canvas>
                                </div>
                            </article>
                            <article class="card-universal flex-column card-padding chart-card">
                                <header class="flex-between header-spacing">
                                    <h3 class="text-title-sm">Test Tag Distribution</h3>
                                    <div class="flex-gap-8">
                                        <button class="btn-base btn-sm flex-center chart-download-btn" type="button" data-tooltip="Download Chart" data-placement="bottom">
                                            <svg aria-hidden="true"><use href="#icon-export"></use></svg>
                                        </button>
                                        <div class="icon-box-sm flex-center">
                                            <svg aria-hidden="true"><use href="#icon-chart-bar"></use></svg>
                                        </div>
                                    </div>
                                </header>
                                <div class="card-content" id="test-tag-distribution-chart">
                                    <canvas id="chartTagDistribution"></canvas>
                                </div>
                            </article>
                            <article class="card-universal flex-column card-padding chart-card">
                                <header class="flex-between header-spacing">
                                    <h3 class="text-title-sm">Test Execution Timeline</h3>
                                    <div class="flex-gap-8">
                                        <button class="btn-base btn-sm flex-center chart-download-btn" type="button" data-tooltip="Download Chart" data-placement="bottom">
                                            <svg aria-hidden="true"><use href="#icon-export"></use></svg>
                                        </button>
                                        <div class="icon-box-sm flex-center">
                                            <svg aria-hidden="true"><use href="#icon-chart-line"></use></svg>
                                        </div>
                                    </div>
                                </header>
                                <div class="card-content" id="test-execution-timeline-chart">
                                    <canvas id="chartExecutionTimeline"></canvas>
                                </div>
                            </article>
                        </div>
                    </div>
                    <div class="dashboard-col-right">
                        <div class="grid-datetime">
                            <article class="card-universal flex-column card-padding" data-type="date">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">DATE</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-calendar"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value" id="reportDate">25 Feb, 2025</div>
                            </article>
                            <article class="card-universal flex-column card-padding" data-type="time">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">TIME</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-clock"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value" id="reportTime">11:44 AM - EST</div>
                            </article>
                        </div>
                        <div class="grid-meta">
                            <article class="card-universal flex-column card-padding" data-type="project">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">Project</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-meta-project"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value">2025 Spring Release</div>
                            </article>
                            <article class="card-universal flex-column card-padding" data-type="application">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">Application</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-meta-application"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value">B2B</div>
                            </article>
                            <article class="card-universal flex-column card-padding" data-type="environment">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">Environment</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-meta-environment"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value">AWS-SIT</div>
                            </article>
                            <article class="card-universal flex-column card-padding" data-type="tester">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">Tester</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-meta-tester"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value">Deepak</div>
                            </article>
                            <article class="card-universal flex-column card-padding" data-type="browser">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">Browser</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-meta-browser"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value">Chrome</div>
                            </article>
                            <article class="card-universal flex-column card-padding" data-type="custom">
                                <div class="flex-between header-spacing">
                                    <h4 class="text-title-sm">Custom Field</h4>
                                    <div class="icon-box-sm flex-center icon-muted">
                                        <svg aria-hidden="true"><use href="#icon-meta-custom"></use></svg>
                                    </div>
                                </div>
                                <div class="text-value">Custom Value</div>
                            </article>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="ui-testing" class="content-section" role="tabpanel" aria-labelledby="nav-ui-testing" tabindex="-1">
            <div class="ui-testing-layout">

                <div class="ui-testing-col-left">
                    <article class="card-universal h-full flex-column">
                        <header class="glass-header flex-gap-12 p-10 sticky-header" style="height: 60px;">
                            <div class="icon-box flex-center">
                                <svg fill="currentColor">
                                    <use href="#icon-ui-testing"></use>
                                </svg>
                            </div>
                            <div class="search-container flex-1">
                                <input type="text" class="search-input" placeholder="Search tests..."
                                    aria-label="Search tests">
                                <button class="btn-base btn-md flex-center search-btn" aria-label="Search">
                                    <svg fill="currentColor">
                                        <use href="#icon-search"></use>
                                    </svg>
                                </button>
                            </div>
                            <div class="dropdown-container">
                                <button id="testFilterButton" class="btn-base btn-md flex-center relative" aria-label="Filter Tests"
                                    aria-haspopup="true" aria-expanded="false" data-tooltip="Filter Tests"
                                    data-placement="bottom">
                                    <svg fill="currentColor">
                                        <use href="#icon-filter"></use>
                                    </svg>
                                    <span class="dropdown-badge" test-status="all">All</span>
                                </button>
                                <div id="testFilterDropdown" class="dropdown-menu min-w-70 z-200">
                                    <div class="dropdown-option active" data-test-filter="all">
                                        <span class="dropdown-option-indicator" test-status="all"></span>
                                        <span>All</span>
                                    </div>
                                    <div class="dropdown-option" data-test-filter="pass">
                                        <span class="dropdown-option-indicator" test-status="pass"></span>
                                        <span>Pass</span>
                                    </div>
                                    <div class="dropdown-option" data-test-filter="fail">
                                        <span class="dropdown-option-indicator" test-status="fail"></span>
                                        <span>Fail</span>
                                    </div>
                                    <div class="dropdown-option" data-test-filter="skip">
                                        <span class="dropdown-option-indicator" test-status="skip"></span>
                                        <span>Skip</span>
                                    </div>
                                </div>
                            </div>
                        </header>
                        <div class="card-content h-full">
                            <div class="test-list-container scrollable" id="test-list-container">
                                <article class="test-card-interactive" test-status="pass" data-test-id="TC001" data-test-card="true"
                                    role="button" tabindex="0" aria-selected="true">
                                    <div class="id-badge">
                                        <span class="id-label">#ID</span>
                                        <span class="id-value">TC001</span>
                                    </div>
                                    <div class="test-info-container">
                                        <h4 class="text-title-sm text-ellipsis mb-5">Login Test</h4>
                                        <div class="test-meta">
                                            <span class="meta-item"><svg fill="currentColor">
                                                    <use href="#icon-calendar"></use>
                                                </svg>Jul 20, 2023</span>
                                            <span class="meta-item"><svg fill="currentColor">
                                                    <use href="#icon-clock"></use>
                                                </svg>10:30 AM</span>
                                        </div>
                                    </div>
                                    <div class="status-badge" test-status="pass">PASS</div>
                                </article>
                                <article class="test-card-interactive" test-status="fail" data-test-id="TC002" data-test-card="true"
                                    role="button" tabindex="0" aria-selected="false">
                                    <div class="id-badge">
                                        <span class="id-label">#ID</span>
                                        <span class="id-value">TC002</span>
                                    </div>
                                    <div class="test-info-container">
                                        <h4 class="text-title-sm text-ellipsis mb-5">Signup Test</h4>
                                        <div class="test-meta">
                                            <span class="meta-item"><svg fill="currentColor">
                                                    <use href="#icon-calendar"></use>
                                                </svg>Jul 20, 2023</span>
                                            <span class="meta-item"><svg fill="currentColor">
                                                    <use href="#icon-clock"></use>
                                                </svg>11:00 AM</span>
                                        </div>
                                    </div>
                                    <div class="status-badge" test-status="fail">FAIL</div>
                                </article>
                                <article class="test-card-interactive" test-status="skip" data-test-id="TC003" data-test-card="true"
                                    role="button" tabindex="0" aria-selected="false">
                                    <div class="id-badge">
                                        <span class="id-label">#ID</span>
                                        <span class="id-value">TC003</span>
                                    </div>
                                    <div class="test-info-container">
                                        <h4 class="text-title-sm text-ellipsis mb-5">Search Functionality Test</h4>
                                        <div class="test-meta">
                                            <span class="meta-item"><svg fill="currentColor">
                                                    <use href="#icon-calendar"></use>
                                                </svg>Jul 20, 2023</span>
                                            <span class="meta-item"><svg fill="currentColor">
                                                    <use href="#icon-clock"></use>
                                                </svg>12:00 PM</span>
                                        </div>
                                    </div>
                                    <div class="status-badge" test-status="skip">SKIP</div>
                                </article>
                            </div>
                        </div>
                    </article>
                </div>

                <div class="ui-testing-col-right">
                    <div class="test-details-header">
                        <div class="test-details-icon">
                            <svg fill="currentColor">
                                <use href="#icon-details"></use>
                            </svg>
                        </div>
                        <h3 class="test-details-title">Test Details</h3>
                        <div class="dropdown-container">
                            <button class="export-button" id="exportButton" aria-label="Export test results">
                                <svg fill="currentColor">
                                    <use href="#icon-export"></use>
                                </svg>
                                <span>Export</span>
                            </button>
                            <div id="exportDropdown" class="dropdown-menu min-w-180 z-200">
                                <div class="dropdown-option" data-export-type="csv">
                                    <span class="dropdown-option-indicator">
                                        <svg class="w-16 h-16" fill="currentColor">
                                            <use href="#icon-download"></use>
                                        </svg>
                                    </span>
                                    <span>Export as CSV</span>
                                </div>
                                <div class="dropdown-option" data-export-type="json">
                                    <span class="dropdown-option-indicator">
                                        <svg class="w-16 h-16" fill="currentColor">
                                            <use href="#icon-json-compare"></use>
                                        </svg>
                                    </span>
                                    <span>Export as JSON</span>
                                </div>
                                <div class="dropdown-option" data-export-type="all-csv">
                                    <span class="dropdown-option-indicator">
                                        <svg class="w-16 h-16" fill="currentColor">
                                            <use href="#icon-download"></use>
                                        </svg>
                                    </span>
                                    <span>All tests in CSV</span>
                                </div>
                                <div class="dropdown-option" data-export-type="all-json">
                                    <span class="dropdown-option-indicator">
                                        <svg class="w-16 h-16" fill="currentColor">
                                            <use href="#icon-json-compare"></use>
                                        </svg>
                                    </span>
                                    <span>All tests in JSON</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="test-details-content">
                        <!-- Test Information Section -->
                        <section class="test-info-section">
                            <article class="card-universal">
                                <header class="glass-header flex-between">
                                    <div class="flex-gap-8">
                                        <div class="icon-box-sm flex-center">
                                            <svg fill="currentColor" width="16" height="16">
                                                <use href="#icon-info"></use>
                                            </svg>
                                        </div>
                                        <h3 class="text-title">Test Information</h3>
                                    </div>
                                    <div class="flex-gap-8">
                                        <div class="status-badge" test-status="pass">PASS</div>
                                        <button id="test-info-accordion-toggle" class="btn-base btn-sm flex-center"
                                            aria-label="Toggle Test Information" aria-haspopup="false"
                                            aria-expanded="true" type="button">
                                            <svg id="test-info-accordion-icon" fill="currentColor">
                                                <use href="#icon-chevron-down"></use>
                                            </svg>
                                        </button>
                                    </div>
                                </header>
                                <div class="card-content">
                                    <div class="test-info-panel d-block p-15 pt-10" data-test-id="TC001">
                                        <div class="grid-3-col mb-20">
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-test-id"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label">Test ID</span>
                                                    <span class="text-info-value" id="test-info-id">TC001</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-duration"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label">Duration</span>
                                                    <span class="text-info-value" id="test-info-duration">00:01:45</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-tags"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label mb-5">Tags</span>
                                                    <div class="flex-wrap flex-gap-4">
                                                        <div class="badge tag-1" id="tag-1">Smoke</div>
                                                        <div class="badge tag-2" id="tag-2">Regression</div>
                                                        <div class="badge tag-3" id="tag-3">Functional</div>
                                                        <div class="badge tag-4" id="tag-4">Dry Run</div>
                                                        <div class="badge tag-5" id="tag-5">Integration</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="grid-1-col">
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-test-name"></use></svg>
                                                </div>
                                                <div class="flex-column-start flex-1">
                                                    <span class="text-info-label">Test Name</span>
                                                    <span class="text-info-value text-ellipsis" id="test-info-name"></span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-description"></use></svg>
                                                </div>
                                                <div class="flex-column-start flex-1">
                                                    <span class="text-info-label">Description</span>
                                                    <span class="text-info-value text-ellipsis" id="test-info-description"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="test-info-panel d-none p-15 pt-10" data-test-id="TC002">
                                        <div class="grid-3-col mb-20">
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-test-id"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label">Test ID</span>
                                                    <span class="text-info-value" id="test-info-id">TC002</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-duration"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label">Duration</span>
                                                    <span class="text-info-value" id="test-info-duration">00:01:45</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-tags"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label mb-5">Tags</span>
                                                    <div class="flex-wrap flex-gap-4">
                                                        <div class="badge tag-1" id="tag-1">Smoke</div>
                                                        <div class="badge tag-2" id="tag-2">Regression</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="grid-1-col">
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-test-name"></use></svg>
                                                </div>
                                                <div class="flex-column-start flex-1">
                                                    <span class="text-info-label">Test Name</span>
                                                    <span class="text-info-value text-ellipsis" id="test-info-name">Signup Test</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-description"></use></svg>
                                                </div>
                                                <div class="flex-column-start flex-1">
                                                    <span class="text-info-label">Description</span>
                                                    <span class="text-info-value text-ellipsis" id="test-info-description">This test verifies the signup process.</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="test-info-panel d-none p-15 pt-10" data-test-id="TC003">
                                        <div class="grid-3-col mb-20">
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-test-id"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label">Test ID</span>
                                                    <span class="text-info-value" id="test-info-id">TC003</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-duration"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label">Duration</span>
                                                    <span class="text-info-value" id="test-info-duration">00:01:45</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-tags"></use></svg>
                                                </div>
                                                <div class="flex-column-start">
                                                    <span class="text-info-label mb-5">Tags</span>
                                                    <div class="flex-wrap flex-gap-4">
                                                        <div class="badge tag-2" id="tag-2">Regression</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="grid-1-col">
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-test-name"></use></svg>
                                                </div>
                                                <div class="flex-column-start flex-1">
                                                    <span class="text-info-label">Test Name</span>
                                                    <span class="text-info-value text-ellipsis" id="test-info-name">Login Test with Invalid Credentials</span>
                                                </div>
                                            </div>
                                            <div class="flex-start flex-gap-12">
                                                <div class="icon-box-sm flex-center">
                                                    <svg fill="currentColor"><use href="#icon-description"></use></svg>
                                                </div>
                                                <div class="flex-column-start flex-1">
                                                    <span class="text-info-label">Description</span>
                                                    <span class="text-info-value text-ellipsis" id="test-info-description">This test verifies the login process with invalid credentials.</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </article>
                        </section>

                        <!-- Test Logs Section -->
                        <section class="test-logs-section flex-1 flex-column overflow-hidden p-10 pb-5">
                            <article class="card-universal h-full flex-column">
                                <header class="glass-header flex-between p-15">
                                    <div class="flex-gap-8">
                                        <div class="icon-box-sm flex-center">
                                            <svg fill="currentColor">
                                                <use href="#icon-logs"></use>
                                            </svg>
                                        </div>
                                        <h3 class="text-title">Test Logs</h3>
                                    </div>
                                    <div class="flex-gap-8">
                                        <div class="flex-gap-4">
                                            <div class="badge badge-secondary" data-tooltip="Total Logs"
                                                data-placement="bottom" id="total-logs-count">0</div>
                                            <div class="badge badge-success" data-tooltip="Pass Logs"
                                                data-placement="bottom" id="pass-logs-count">0</div>
                                            <div class="badge badge-danger" data-tooltip="Fail Logs"
                                                data-placement="bottom" id="fail-logs-count">0</div>
                                            <div class="badge badge-warning" data-tooltip="Skip Logs"
                                                data-placement="bottom" id="skip-logs-count">0</div>
                                            <div class="badge badge-primary" data-tooltip="Info Logs"
                                                data-placement="bottom" id="info-logs-count">0</div>
                                        </div>
                                        <div class="dropdown-container">
                                            <button id="logsFilterButton" class="btn-base btn-md flex-center relative"
                                                aria-label="Filter logs" aria-haspopup="true" aria-expanded="false"
                                                data-tooltip="Filter Logs" data-placement="bottom">
                                                <svg fill="currentColor">
                                                    <use href="#icon-filter"></use>
                                                </svg>
                                                <span class="dropdown-badge" log-status="all">All</span>
                                            </button>
                                            <div id="logsFilterDropdown" class="dropdown-menu min-w-70 z-200">
                                                <div class="dropdown-option active" data-log-filter="all">
                                                    <span class="status-indicator" log-status="all"></span>
                                                    <span>All</span>
                                                </div>
                                                <div class="dropdown-option" data-log-filter="pass">
                                                    <span class="status-indicator" log-status="pass"></span>
                                                    <span>Pass</span>
                                                </div>
                                                <div class="dropdown-option" data-log-filter="fail">
                                                    <span class="status-indicator" log-status="fail"></span>
                                                    <span>Fail</span>
                                                </div>
                                                <div class="dropdown-option" data-log-filter="skip">
                                                    <span class="status-indicator" log-status="skip"></span>
                                                    <span>Skip</span>
                                                </div>
                                                <div class="dropdown-option" data-log-filter="info">
                                                    <span class="status-indicator" log-status="info"></span>
                                                    <span>Info</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </header>
                                <div class="card-content scrollable p-15 h-full">
                                    <div class="test-logs-panel d-block" data-test-id="TC001">
                                        <article class="log-card log-item" log-status="pass" data-log-item="true"
                                            data-log-id="1">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="pass"></div>
                                                <div class="log-id">Log #1</div>
                                                <div class="log-name">Login page loaded</div>
                                                <div class="log-time">
                                                    <svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>
                                                    10:30:15
                                                </div>
                                                <div class="log-actions">
                                                    <button class="btn-base btn-sm flex-center" aria-label="View screenshot" data-modal="image" data-log-id="Log #1" data-image-url="https://picsum.photos/seed/picsum/1280/720">
                                                        <svg fill="currentColor"><use href="#icon-image"></use></svg>
                                                    </button>
                                                    <button class="btn-base btn-sm flex-center log-toggle" aria-label="Toggle details">
                                                        <svg fill="currentColor"><use href="#icon-chevron-down"></use></svg>
                                                    </button>
                                                </div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:30:15</div>
                                                    <div class="log-message-col">
                                                        <p>Login page loaded</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </article>
                                        <article class="log-card log-item" log-status="fail" data-log-item="true"
                                            data-log-id="2">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="fail"></div>
                                                <div class="log-id">Log #2</div>
                                                <div class="log-name"><i>No message provided</i></div>
                                                <div class="log-time"><svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>10:31:00</div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center disabled"
                                                        aria-label="No screenshot available"><svg fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:31:00</div>
                                                    <div class="log-message-col">
                                                        <p><i>No message provided</i></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </article>
                                    </div>
                                    <div class="test-logs-panel d-none" data-test-id="TC002">
                                        <article class="log-card log-item" log-status="pass" data-log-item="true"
                                            data-log-id="1">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="pass"></div>
                                                <div class="log-id">Log #1</div>
                                                <div class="log-name">Login page loaded</div>
                                                <div class="log-time">
                                                    <svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>
                                                    10:30:15
                                                </div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center"
                                                        aria-label="View screenshot" data-modal="image"
                                                        data-log-id="Log #1" data-log-name="Login page loaded"
                                                        data-image-url="https://picsum.photos/seed/picsum/1280/720"><svg
                                                            fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:30:15</div>
                                                    <div class="log-message-col">
                                                        <p>Login page loaded</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </article>
                                        <article class="log-card log-item" log-status="info" data-log-item="true"
                                            data-log-id="3">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="info"></div>
                                                <div class="log-id">Log #3</div>
                                                <div class="log-name">Login retried successfully</div>
                                                <div class="log-time"><svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>10:31:45</div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center"
                                                        aria-label="View screenshot" data-modal="image"
                                                        data-log-id="Log #3" data-log-name="Login retried successfully"
                                                        data-image-url="https://picsum.photos/seed/picsum/1280/720"><svg
                                                            fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:31:45</div>
                                                    <div class="log-message-col">
                                                        <p>Login retried successfully</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </article>
                                        <article class="log-card log-item" log-status="skip" data-log-item="true"
                                            data-log-id="4">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="skip"></div>
                                                <div class="log-id">Log #4</div>
                                                <div class="log-name">Login retried successfully</div>
                                                <div class="log-time"><svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>10:31:45</div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center"
                                                        aria-label="View screenshot" data-modal="image"
                                                        data-log-id="Log #4" data-log-name="Login retried successfully"
                                                        data-image-url="./sample.png"><svg fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:31:45</div>
                                                    <div class="log-message-col">
                                                    <p>Login retried successfully</p>
                                                </div>
                                            </div>
                                        </article>
                                    </div>
                                    <div class="test-logs-panel d-none" data-test-id="TC003">
                                        <article class="log-card log-item" log-status="pass" data-log-item="true"
                                            data-log-id="1">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="pass"></div>
                                                <div class="log-id">Log #1</div>
                                                <div class="log-name">Login page loaded</div>
                                                <div class="log-time">
                                                    <svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>
                                                    10:30:15
                                                </div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center"
                                                        aria-label="View screenshot" data-modal="image"
                                                        data-log-id="Log #1" data-log-name="Login page loaded"
                                                        data-image-url="https://picsum.photos/seed/picsum/1280/720"><svg
                                                            fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:30:15</div>
                                                    <div class="log-message-col">
                                                    <p>Login page loaded</p>
                                                </div>
                                            </div>
                                        </article>
                                        <article class="log-card log-item" log-status="fail" data-log-item="true"
                                            data-log-id="2">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="fail"></div>
                                                <div class="log-id">Log #2</div>
                                                <div class="log-name"><i>No message provided</i></div>
                                                <div class="log-time"><svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>10:31:00</div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center disabled"
                                                        aria-label="No screenshot available"><svg fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:31:00</div>
                                                    <div class="log-message-col">
                                                    <p><i>No message provided</i></p>
                                                </div>
                                            </div>
                                        </article>
                                        <article class="log-card log-item" log-status="info" data-log-item="true"
                                            data-log-id="3">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="info"></div>
                                                <div class="log-id">Log #3</div>
                                                <div class="log-name">Login retried successfully</div>
                                                <div class="log-time"><svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>10:31:45</div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center"
                                                        aria-label="View screenshot" data-modal="image"
                                                        data-log-id="Log #3" data-log-name="Login retried successfully"
                                                        data-image-url="https://picsum.photos/seed/picsum/1280/720"><svg
                                                            fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:31:45</div>
                                                    <div class="log-message-col">
                                                    <p>Login retried successfully</p>
                                                </div>
                                            </div>
                                        </article>
                                        <article class="log-card log-item" log-status="skip" data-log-item="true"
                                            data-log-id="4">
                                            <header class="log-header">
                                                <div class="status-bar" log-status="skip"></div>
                                                <div class="log-id">Log #4</div>
                                                <div class="log-name">Login retried successfully</div>
                                                <div class="log-time"><svg fill="currentColor">
                                                        <use href="#icon-duration"></use>
                                                    </svg>10:31:45</div>
                                                <div class="log-actions"><button class="btn-base btn-sm flex-center"
                                                        aria-label="View screenshot" data-modal="image"
                                                        data-log-id="Log #4" data-log-name="Login retried successfully"
                                                        data-image-url="./sample.png"><svg fill="currentColor">
                                                            <use href="#icon-image"></use>
                                                        </svg></button><button class="btn-base btn-sm flex-center log-toggle"
                                                        aria-label="Toggle details"><svg fill="currentColor">
                                                            <use href="#icon-chevron-down"></use>
                                                        </svg></button></div>
                                            </header>
                                            <div class="expandable-content">
                                                <div class="log-content-grid">
                                                    <div class="log-time-col">10:31:45</div>
                                                    <div class="log-message-col">
                                                        <p>Login retried successfully</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </article>
                                    </div>
                                </div>
                            </article>
                        </section>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div id="toastContainer" class="fixed bottom-8 left-1-2 transform-center-x z-2000 flex flex-column items-center pointer-events-none"></div>

    <!-- Modal for Screenshots -->
    <div class="d-none fixed inset-0 z-1000 overflow-auto overlay" id="mediaModal">
        <div class="bg-main my-5p m-auto border-base rounded-lg w-4-5 max-w-1000 max-h-80vh flex flex-column relative modal-fade-in">
            <!-- Modal Header -->
            <div class="py-12 px-18 border-b border-base flex rounded-t-lg flex-between items-center">
                <div class="flex items-center flex-gap-10">
                    <div class="w-30 h-30 flex-center bg-color border-base rounded-md shadow-soft">
                        <svg id="modalMediaIcon" fill="currentColor">
                            <use href="#icon-image"></use>
                        </svg>
                    </div>
                    <h5 id="modalLogId" class="m-0 text-sm font-semibold text-color">Log #1</h5>
                </div>
                <button class="bg-color border-base cursor-pointer text-muted p-5 rounded-full flex-center shadow-soft hover-shadow-inset" title="Close" data-tooltip="Close" data-placement="left">
                    <svg fill="currentColor" class="w-24 h-24">
                        <use href="#icon-close"></use>
                    </svg>
                </button>
            </div>

            <!-- Modal Body -->
            <div class="p-10 overflow-auto flex-1 flex-center min-h-300 max-h-70vh bg-color relative shadow-inset">
                <!-- Loading animation -->
                <div id="loadingContainer" class="d-flex items-center justify-center h-full w-full absolute inset-0 z-1 bg-color text-muted">
                    <div class="flex flex-column items-center justify-center">
                        <div class="text-muted mb-10">
                            <svg viewBox="0 0 24 24" fill="currentColor" class="w-40 h-40">
                                <use href="#icon-loading"></use>
                            </svg>
                        </div>
                        <div class="text-muted text-sm font-semibold">Loading media...</div>
                    </div>
                </div>

                <div id="mediaErrorMessage"></div>

                <div id="imageContainer" class="w-full h-full items-center justify-center relative" style="display: none;">
                    <div class="media-zoom-wrapper relative w-full h-full flex items-center justify-center" id="mediaZoomWrapper">
                        <img id="modalImage" src="" alt="Screenshot" class="w-auto h-auto object-contain border-base bg-white max-w-full max-h-full block"
                            crossorigin="anonymous">
                        <canvas id="annotationCanvas"></canvas>
                    </div>
                    
                    <!-- Annotation Tools - Floating over image -->
                    <div id="annotationTools" class="absolute bottom-8 left-1-2 transform-center-x bg-color border-base rounded-lg p-8 z-50 flex flex-column items-center shadow-soft min-w-420" style="display: none;">
                    <div class="inline-flex items-center gap-6 mb-6">
                        <div class="color-option active bg-red w-24 h-24 rounded-full cursor-pointer border-base shadow-soft transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Red" data-placement="top" data-color="#FF0000"></div>
                        <div class="color-option bg-green w-24 h-24 rounded-full cursor-pointer border-base shadow-soft transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Green" data-placement="top" data-color="#00FF00"></div>
                        <div class="color-option bg-blue w-24 h-24 rounded-full cursor-pointer border-base shadow-soft transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Blue" data-placement="top" data-color="#0000FF"></div>
                        <div class="color-option bg-yellow w-24 h-24 rounded-full cursor-pointer border-base shadow-soft transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Yellow" data-placement="top" data-color="#FFFF00"></div>
                        <div class="color-option bg-magenta w-24 h-24 rounded-full cursor-pointer border-base shadow-soft transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Pink" data-placement="top" data-color="#FF00FF"></div>
                    </div>
                    <div class="inline-flex items-center gap-6">
                        <button class="shape-btn w-32 h-32 flex-center border-base rounded-md bg-color shadow-soft cursor-pointer text-color transition-fast hover-shadow-inset active-shadow-inset" id="rectTool" data-shape="rectangle" data-tooltip="Rectangle" data-placement="top">
                            <svg fill="currentColor" class="w-16 h-16">
                                <use href="#icon-rectangle"></use>
                            </svg>
                        </button>
                        <button class="shape-btn w-32 h-32 flex-center border-base rounded-md bg-color shadow-soft cursor-pointer text-color transition-fast hover-shadow-inset active-shadow-inset" id="circleTool" data-shape="circle" data-tooltip="Circle" data-placement="top">
                            <svg fill="currentColor" class="w-16 h-16">
                                <use href="#icon-circle"></use>
                            </svg>
                        </button>
                        <button class="shape-btn w-32 h-32 flex-center border-base rounded-md bg-color shadow-soft cursor-pointer text-color transition-fast hover-shadow-inset active-shadow-inset" id="lineTool" data-shape="line" data-tooltip="Line" data-placement="top">
                            <svg fill="currentColor" class="w-16 h-16">
                                <use href="#icon-line"></use>
                            </svg>
                        </button>
                        <button class="shape-btn w-32 h-32 flex-center border-base rounded-md bg-color shadow-soft cursor-pointer text-color transition-fast hover-shadow-inset active-shadow-inset" id="arrowTool" data-shape="arrow" data-tooltip="Arrow" data-placement="top">
                            <svg fill="currentColor" class="w-16 h-16">
                                <use href="#icon-arrow"></use>
                            </svg>
                        </button>
                        <button class="shape-btn w-32 h-32 flex-center border-base rounded-md bg-color shadow-soft cursor-pointer text-color transition-fast hover-shadow-inset active-shadow-inset" id="undoBtn" data-tooltip="Undo" data-placement="top">
                            <svg fill="currentColor" class="w-16 h-16">
                                <use href="#icon-undo"></use>
                            </svg>
                        </button>
                        <button class="shape-btn w-32 h-32 flex-center border-base rounded-md bg-color shadow-soft cursor-pointer text-color transition-fast hover-shadow-inset active-shadow-inset" id="redoBtn" data-tooltip="Redo" data-placement="top">
                            <svg fill="currentColor" class="w-16 h-16">
                                <use href="#icon-redo"></use>
                            </svg>
                        </button>
                        <button class="clear-btn w-32 h-32 rounded-md border-base shadow-soft flex-center p-4 text-color bg-color cursor-pointer transition-fast hover-shadow-inset active-shadow-inset" id="clearAnnotations" data-tooltip="Clear All" data-placement="top">
                            <svg fill="currentColor" class="w-14 h-14">
                                <use href="#icon-close"></use>
                            </svg>
                        </button>
                    </div>
                </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="py-12 px-18 border-t">
                <div class="d-flex items-center justify-center gap-6">
                    <button id="zoomIn" class="w-32 h-32 flex-center border-base rounded-sm bg-color shadow-soft text-color cursor-pointer transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Zoom In (+)" data-placement="top">
                        <svg fill="currentColor" class="w-16 h-16">
                            <use href="#icon-zoom-in"></use>
                        </svg>
                    </button>
                    <button id="zoomOut" class="w-32 h-32 flex-center border-base rounded-sm bg-color shadow-soft text-color cursor-pointer transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Zoom Out (-)" data-placement="top">
                        <svg fill="currentColor" class="w-16 h-16">
                            <use href="#icon-zoom-out"></use>
                        </svg>
                    </button>
                    <button id="annotateBtn" class="w-32 h-32 flex-center border-base rounded-sm bg-color shadow-soft text-color cursor-pointer transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Annotate (Shift+A)" data-placement="top">
                        <svg fill="currentColor" class="w-16 h-16">
                            <use href="#icon-pencil"></use>
                        </svg>
                    </button>
                    <button id="downloadBtn" class="w-32 h-32 flex-center border-base rounded-sm bg-color shadow-soft text-color cursor-pointer transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Download (Shift+D)" data-placement="top">
                        <span class="download-btn-icon">
                            <svg fill="currentColor" class="w-16 h-16">
                                <use href="#icon-download"></use>
                            </svg>
                        </span>
                        <span class="download-btn-loading d-none">
                            <svg fill="currentColor" class="w-16 h-16 download-loading">
                                <use href="#icon-loading"></use>
                            </svg>
                        </span>
                    </button>
                    <button id="reset" class="w-32 h-32 flex-center border-base rounded-sm bg-color shadow-soft text-color cursor-pointer transition-fast hover-shadow-inset active-shadow-inset" data-tooltip="Reset (Shift+R)" data-placement="top">
                        <svg fill="currentColor" class="w-16 h-16">
                            <use href="#icon-reload"></use>
                        </svg>
                    </button>
                    
                </div>
            </div>
        </div>
    </div>

    <!-- SVG Icons Definitions -->
    <svg class="d-none">

        <symbol id="icon-reload" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M17.65 6.35A7.95 7.95 0 0012 4a8 8 0 108 8h-2a6 6 0 11-6-6c1.3 0 2.5.44 3.45 1.17L13 11h7V4l-2.35 2.35z">
            </path>
        </symbol>

        <symbol id="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <path
                d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42">
            </path>
        </symbol>

        <symbol id="icon-moon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M21.75 12.33A9 9 0 1 1 11.67 2.25a7 7 0 0 0 10.08 10.08z"></path>
        </symbol>

        <symbol id="icon-dashboard" viewBox="0 0 24 24" fill="currentColor">
            <rect x="3" y="3" width="8" height="7" />
            <rect x="14" y="3" width="8" height="7" />
            <rect x="14" y="14" width="8" height="7" />
            <rect x="3" y="14" width="8" height="7" />
        </symbol>

        <symbol id="icon-ui-testing" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="3" width="20" height="14" rx="2" ry="2" />
            <line x1="8" y1="21" x2="16" y2="21" />
            <line x1="12" y1="17" x2="12" y2="21" />
        </symbol>

        <symbol id="icon-api-testing" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="7" y="7" width="10" height="10" rx="2" ry="2" />
            <line x1="10" y1="1" x2="10" y2="4" />
            <line x1="14" y1="1" x2="14" y2="4" />
            <line x1="10" y1="20" x2="10" y2="23" />
            <line x1="14" y1="20" x2="14" y2="23" />
            <line x1="1" y1="10" x2="4" y2="10" />
            <line x1="1" y1="14" x2="4" y2="14" />
            <line x1="20" y1="10" x2="23" y2="10" />
            <line x1="20" y1="14" x2="23" y2="14" />
        </symbol>

        <symbol id="icon-pdf-compare" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
            <polyline points="14,2 14,8 20,8" />
            <line x1="16" y1="13" x2="8" y2="13" />
            <line x1="16" y1="17" x2="8" y2="17" />
            <polyline points="10,9 9,9 8,9" />
        </symbol>

        <symbol id="icon-xml-compare" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="16 18 22 12 16 6" />
            <polyline points="8 6 2 12 8 18" />
        </symbol>

        <symbol id="icon-json-compare" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12s2.545-5 7-5c4.454 0 7 5 7 5s-2.546 5-7 5c-4.455 0-7-5-7-5z" />
            <path d="M12 13a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
            <path d="M21 17v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2" />
            <path d="M21 7V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2" />
        </symbol>

        <symbol id="icon-calendar" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zM9 14H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2z" />
        </symbol>

        <symbol id="icon-clock" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z" />
        </symbol>

        <symbol id="icon-eye" viewBox="0 0 20 20" fill="currentColor">
            <path
                d="M10 4c-5 0-8 6-8 6s3 6 8 6 8-6 8-6-3-6-8-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm0-6.5a2 2 0 100 4 2 2 0 000-4z" />
        </symbol>

        <!-- Status Icons -->
        <symbol id="icon-status-pass" viewBox="0 0 20 20" fill="currentColor">
            <circle cx="10" cy="10" r="9" stroke="#4caf50" stroke-width="2" fill="#e8f5e9" />
            <polyline points="6,11 9,14 14,7" fill="none" stroke="#4caf50" stroke-width="2" />
        </symbol>

        <symbol id="icon-status-fail" viewBox="0 0 20 20" fill="currentColor">
            <circle cx="10" cy="10" r="9" stroke="#f44336" stroke-width="2" fill="#ffebee" />
            <line x1="7" y1="7" x2="13" y2="13" stroke="#f44336" stroke-width="2" />
            <line x1="13" y1="7" x2="7" y2="13" stroke="#f44336" stroke-width="2" />
        </symbol>

        <symbol id="icon-status-skip" viewBox="0 0 20 20" fill="currentColor">
            <circle cx="10" cy="10" r="9" stroke="#ff9800" stroke-width="2" fill="#fff3e0" />
            <rect x="7" y="9" width="6" height="2" fill="#ff9800" />
        </symbol>

        <symbol id="icon-status-total" viewBox="0 0 20 20" fill="currentColor">
            <circle cx="10" cy="10" r="9" stroke="#2196f3" stroke-width="2" fill="#e3f2fd" />
            <text x="10" y="13" text-anchor="middle" font-size="10" fill="#2196f3" font-family="Arial"></text>
        </symbol>

        <!-- Meta Cards Icons -->
        <symbol id="icon-meta-project" viewBox="0 0 16 16" fill="currentColor">
            <rect x="3" y="3" width="10" height="10" rx="2" fill="#ffe082" stroke="#ffb300" stroke-width="1" />
            <rect x="6" y="6" width="4" height="4" fill="#ffb300" />
        </symbol>

        <symbol id="icon-meta-application" viewBox="0 0 16 16" fill="currentColor">
            <rect x="2" y="4" width="12" height="8" rx="2" fill="#e1bee7" stroke="#8e24aa" stroke-width="1" />
            <rect x="6" y="12" width="4" height="1" fill="#8e24aa" />
        </symbol>

        <symbol id="icon-meta-environment" viewBox="0 0 16 16" fill="currentColor">
            <rect x="2" y="6" width="12" height="6" rx="2" fill="#c8e6c9" stroke="#388e3c" stroke-width="1" />
            <circle cx="8" cy="9" r="2" fill="#388e3c" />
        </symbol>

        <symbol id="icon-meta-tester" viewBox="0 0 16 16" fill="currentColor">
            <circle cx="8" cy="6" r="3" fill="#90caf9" />
            <rect x="4" y="10" width="8" height="4" rx="2" fill="#1976d2" />
        </symbol>

        <symbol id="icon-meta-browser" viewBox="0 0 16 16" fill="currentColor">
            <circle cx="8" cy="8" r="7" stroke="#1976d2" stroke-width="1" fill="#e3f2fd" />
            <circle cx="8" cy="8" r="3" fill="#1976d2" />
        </symbol>

        <symbol id="icon-meta-custom" viewBox="0 0 16 16" fill="currentColor">
            <rect x="2" y="2" width="12" height="12" rx="2" fill="#ffcdd2" stroke="#f44336" stroke-width="1" />
            <circle cx="8" cy="8" r="3" fill="#f44336" />
            <rect x="7" y="6" width="2" height="4" fill="#fff" />
        </symbol>

        <symbol id="icon-export" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
        </symbol>

        <!-- Chart Grid Icons -->
        <symbol id="icon-chart-pie" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path>
            <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
        </symbol>

        <symbol id="icon-chart-bar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="20" x2="12" y2="10"></line>
            <line x1="18" y1="20" x2="18" y2="4"></line>
            <line x1="6" y1="20" x2="6" y2="16"></line>
        </symbol>

        <symbol id="icon-chart-line" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
        </symbol>

        <symbol id="icon-chart-area" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 3v18h18"></path>
            <path d="M7 12l4-4 4 4 4-4"></path>
        </symbol>

        <!-- UI Testing Icons -->
        <symbol id="icon-search" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8" />
            <line x1="21" y1="21" x2="16.65" y2="16.65" />
        </symbol>

        <symbol id="icon-filter" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
        </symbol>

        <symbol id="icon-details" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="2" width="20" height="20" rx="2" stroke="currentColor" stroke-width="2" fill="none" />
            <line x1="8" y1="8" x2="16" y2="8" stroke="currentColor" stroke-width="2" />
            <line x1="8" y1="12" x2="16" y2="12" stroke="currentColor" stroke-width="2" />
            <line x1="8" y1="16" x2="13" y2="16" stroke="currentColor" stroke-width="2" />
        </symbol>

        <symbol id="icon-chevron-down" viewBox="0 0 16 16" fill="currentColor">
            <path fill-rule="evenodd"
                d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z" />
        </symbol>

        <symbol id="icon-info" viewBox="0 0 20 20" fill="currentColor">
            <circle cx="10" cy="10" r="9" stroke="currentColor" stroke-width="2" fill="none" />
            <rect x="9" y="8" width="2" height="6" rx="1" fill="currentColor" />
            <rect x="9" y="5" width="2" height="2" rx="1" fill="currentColor" />
        </symbol>

        <!-- Test Details Icons -->
        <symbol id="icon-test-id" viewBox="0 0 16 16" fill="currentColor">
            <path
                d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
            <path
                d="M6.854 4.646a.5.5 0 0 1 0 .708L4.207 8l2.647 2.646a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 0 1 .708 0zm2.292 0a.5.5 0 0 0 0 .708L11.793 8l-2.647 2.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708 0z" />
        </symbol>

        <symbol id="icon-test-name" viewBox="0 0 16 16" fill="currentColor">
            <path
                d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z" />
        </symbol>

        <symbol id="icon-description" viewBox="0 0 16 16" fill="currentColor">
            <path
                d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" />
            <path
                d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z" />
        </symbol>

        <symbol id="icon-duration" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z" />
        </symbol>

        <symbol id="icon-tags" viewBox="0 0 16 16" fill="currentColor">
            <path
                d="M3 2v4.586l7 7L14.586 9l-7-7H3zM2 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 2 6.586V2z" />
            <path
                d="M5.5 5a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm0 1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM1 7.086a1 1 0 0 0 .293.707L8.75 15.25l-.043.043a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 0 7.586V3a1 1 0 0 1 1-1v5.086z" />
        </symbol>

        <symbol id="icon-image" viewBox="0 0 16 16" fill="currentColor">
            <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
            <path
                d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z" />
        </symbol>

        <!-- Modal Icons -->
        <symbol id="icon-close" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
        </symbol>

        <symbol id="icon-zoom-in" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
            <path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z" />
        </symbol>

        <symbol id="icon-zoom-out" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
            <path d="M7 9h5v1H7z" />
        </symbol>

        <symbol id="icon-annotate" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
        </symbol>

        <symbol id="icon-pencil" viewBox="0 0 24 24" fill="currentColor">
            <path
                d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM21.41 6.34l-3.75-3.75-2.53 2.54 3.75 3.75 2.53-2.54z" />
        </symbol>

        <symbol id="icon-download" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
        </symbol>

        <symbol id="icon-loading" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" opacity="0.15" />
            <path d="M22 12a10 10 0 0 0-10-10" stroke="currentColor" stroke-width="4" stroke-linecap="round">
                <animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="0.8s"
                    repeatCount="indefinite" />
            </path>
        </symbol>

        <!-- Annotation Shape Icons -->
        <symbol id="icon-rectangle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        </symbol>

        <symbol id="icon-circle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="9"></circle>
        </symbol>

        <symbol id="icon-line" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="5" y1="19" x2="19" y2="5"></line>
        </symbol>

        <symbol id="icon-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
        </symbol>

        <symbol id="icon-undo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 7v6h6"></path>
            <path d="M3 13c0-4.4 3.6-8 8-8h6"></path>
            <polyline points="17 21 21 17 17 13"></polyline>
        </symbol>

        <symbol id="icon-redo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 7v6h-6"></path>
            <path d="M21 13c0-4.4-3.6-8-8-8H7"></path>
            <polyline points="7 21 3 17 7 13"></polyline>
        </symbol>


    </svg>

    <!-- ================== GLOBAL UTILITIES ================== -->
    <script>
        // DOM Utilities - reduce repetitive queries and operations
        window.DOMUtils = {
            // Common queries
            get: (selector, context = document) => context.querySelector(selector),
            getAll: (selector, context = document) => Array.from(context.querySelectorAll(selector)),
            
            // Common operations
            addClass: (element, className) => element?.classList.add(className),
            removeClass: (element, className) => element?.classList.remove(className),
            toggleClass: (element, className, force) => element?.classList.toggle(className, force),
            
            // Attribute helpers
            setAttr: (element, name, value) => element?.setAttribute(name, value),
            getAttr: (element, name) => element?.getAttribute(name),
            
            // Show/hide utilities
            show: (element) => { if (element) element.style.display = ''; },
            hide: (element) => { if (element) element.style.display = 'none'; },
            toggle: (element, show) => show ? DOMUtils.show(element) : DOMUtils.hide(element)
        };

        // Global function to create reusable message containers
        window.createMessageContainer = function (kaomoji, message, additionalClasses = '') {
            const msgDiv = document.createElement('div');
            msgDiv.className = `message-container d-flex ${additionalClasses}`.trim();
            msgDiv.innerHTML = `
                <div class="message-box">
                    <div class="kaomoji">${kaomoji}</div>
                    <p>${message}</p>
                </div>
            `;
            return msgDiv;
        };
    </script>

    <!-- ================== FEATURE 1: LOGO ANIMATION ================== -->
    <script>
        // Animate the "R" logo on page load with smooth transition
        document.addEventListener('DOMContentLoaded', function () {
            const rLogo = document.getElementById('r-logo');
            if (!rLogo) return;
            // Use Web Animations API if available
            if (typeof rLogo.animate === 'function') {
                rLogo.animate([
                    { opacity: 0, transform: 'translateY(16px)' },
                    { opacity: 1, transform: 'translateY(0)' }
                ], {
                    duration: 900,
                    fill: 'forwards',
                    easing: 'cubic-bezier(.6,0,.4,1)'
                });
                setTimeout(() => { rLogo.style.opacity = 1; }, 900);
            } else {
                // Fallback for older browsers
                rLogo.style.opacity = 1;
            }
        });
    </script>

    <!-- ================== FEATURE 3: THEME TOGGLE & INITIALIZATION ================== -->
    <script>
        (function () {
            const THEME_KEY = 'visionTheme';
            const body = document.body;
            let currentTheme = body.getAttribute('data-theme') || 'light';

            function setTheme(theme) {
                body.setAttribute('data-theme', theme);
                currentTheme = theme;
                try {
                    localStorage.setItem(THEME_KEY, theme);
                } catch (e) {
                    // Fallback: do nothing
                }
            }

            function toggleTheme() {
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                setTheme(newTheme);
                const themeName = newTheme === 'dark' ? 'Dark Mode' : 'Light Mode';
                if (typeof window.showToast === 'function') {
                    showToast(`Theme switched to ${themeName}`, 'info');
                }
            }

            function initializeTheme() {
                let savedTheme = null;
                try {
                    savedTheme = localStorage.getItem(THEME_KEY);
                } catch (e) { }
                if (savedTheme === 'light' || savedTheme === 'dark') {
                    setTheme(savedTheme);
                } else {
                    setTheme(currentTheme);
                }
            }

            // Attach to theme toggle button
            document.addEventListener('DOMContentLoaded', function () {
                initializeTheme();
                const themeToggleBtn = document.getElementById('themeToggle');
                if (themeToggleBtn) {
                    themeToggleBtn.setAttribute('aria-pressed', currentTheme === 'dark');
                    themeToggleBtn.addEventListener('click', function () {
                        toggleTheme();
                        this.setAttribute('aria-pressed', currentTheme === 'dark');
                    });
                }
            });
        })();
    </script>

    <!-- ================== FEATURE 4: DATA REFRESH (RELOAD) BUTTON ================== -->
    <script>
        (function () {
            document.addEventListener('DOMContentLoaded', function () {
                const reloadBtn = document.querySelector('button[data-tooltip="Reload"]');
                if (!reloadBtn) return;
                reloadBtn.addEventListener('click', function () {
                    if (reloadBtn.disabled) return;
                    reloadBtn.disabled = true;
                    if (typeof window.showToast === 'function') {
                        showToast('Refreshing data...', 'info');
                    }
                    setTimeout(() => {
                        window.location.reload();
                    }, 500);
                });
            });
        })();
    </script>

    <!-- ================== FEATURE 5: SIDEBAR NAVIGATION ================== -->
    <script>
        // Sidebar navigation for switching between main sections with accessibility
        (function () {
            document.addEventListener('DOMContentLoaded', function () {
                const navItems = document.querySelectorAll('.nav-item');
                const sections = document.querySelectorAll('.content-section');
                if (!navItems.length || !sections.length) return;

                navItems.forEach(item => {
                    // Set ARIA attributes
                    item.setAttribute('role', 'tab');
                    item.setAttribute('tabindex', '0');
                    item.setAttribute('aria-selected', item.classList.contains('active'));
                    item.addEventListener('click', function () {
                        activateSection(this);
                    });
                    item.addEventListener('keydown', function (e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            activateSection(this);
                        }
                    });
                });

                function activateSection(item) {
                    const targetSection = item.getAttribute('data-section');
                    navItems.forEach(nav => {
                        nav.classList.remove('active');
                        nav.setAttribute('aria-selected', 'false');
                    });
                    item.classList.add('active');
                    item.setAttribute('aria-selected', 'true');
                    sections.forEach(section => {
                        section.classList.remove('active');
                    });
                    const target = document.getElementById(targetSection);
                    if (target) {
                        target.classList.add('active');
                        target.setAttribute('tabindex', '-1');
                        // target.focus && target.focus(); // Remove or comment out this line
                    }
                }
            });
        })();
    </script>

    <!-- ================== FEATURE 6: DASHBOARD STATUS ANIMATION ================== -->
    <script>
        // Dashboard status cards animation (numbers and progress bars)
        (function () {
            function animateValue(element, start, end, duration, isPercentage) {
                const startTime = performance.now();
                function update(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const current = Math.round(start + (end - start) * (progress * (2 - progress))); // easeOutQuad
                    element.textContent = isPercentage ? current + '%' : current;
                    if (progress < 1) {
                        requestAnimationFrame(update);
                    }
                }
                requestAnimationFrame(update);
            }

            function animateCard(card) {
                const numberEl = document.getElementById(`status${card.id}Number`);
                const percentageEl = document.getElementById(`status${card.id}Percentage`);
                const progressEl = document.getElementById(`status${card.id}Progress`);
                if (!numberEl || !percentageEl || !progressEl) return;
                const targetNumber = parseInt(numberEl.getAttribute(card.numberAttr)) || 0;
                const targetPercentage = parseInt(percentageEl.getAttribute(card.percentageAttr)) || 0;
                numberEl.textContent = '0';
                percentageEl.textContent = '0%';
                numberEl.style.visibility = 'visible';
                percentageEl.style.visibility = 'visible';
                progressEl.style.width = '0%';
                progressEl.style.transition = 'none';
                progressEl.offsetWidth; // force reflow
                progressEl.style.transition = 'width 2s cubic-bezier(0.25,0.46,0.45,0.94)';
                progressEl.style.width = targetPercentage + '%';
                animateValue(numberEl, 0, targetNumber, 2000, false);
                animateValue(percentageEl, 0, targetPercentage, 2000, true);
            }

            function initializeDashboardAnimations() {
                const cards = [
                    { id: 'Pass', numberAttr: 'data-pass-number', percentageAttr: 'data-pass-percentage' },
                    { id: 'Fail', numberAttr: 'data-fail-number', percentageAttr: 'data-fail-percentage' },
                    { id: 'Skip', numberAttr: 'data-skip-number', percentageAttr: 'data-skip-percentage' },
                    { id: 'Total', numberAttr: 'data-total-number', percentageAttr: 'data-total-percentage' }
                ];
                cards.forEach((card, idx) => {
                    setTimeout(() => animateCard(card), idx * 200);
                });
            }

            // Global function to navigate to UI Testing with specific filter
            window.navigateToUITestingWithFilter = function (filterStatus) {
                // 1. Switch to UI Testing section
                const uiTestingNavItem = document.querySelector('.nav-item[data-section="ui-testing"]');
                const uiTestingSection = document.getElementById('ui-testing');
                const dashboardSection = document.getElementById('dashboard');

                if (!uiTestingNavItem || !uiTestingSection || !dashboardSection) {
                    console.error('Required UI elements not found');
                    return;
                }

                // Update navigation active states
                document.querySelectorAll('.nav-item').forEach(nav => {
                    nav.classList.remove('active');
                    nav.setAttribute('aria-selected', 'false');
                });
                uiTestingNavItem.classList.add('active');
                uiTestingNavItem.setAttribute('aria-selected', 'true');

                // Update section visibility
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                uiTestingSection.classList.add('active');
                uiTestingSection.setAttribute('tabindex', '-1');
                if (uiTestingSection.focus) uiTestingSection.focus();

                // 2. Apply the filter after a short delay to ensure UI has switched
                setTimeout(() => {
                    applyTestFilter(filterStatus);

                    // 3. Show toast notification
                    if (typeof window.showToast === 'function') {
                        const filterText = filterStatus === 'all' ? 'All tests' : `${filterStatus.charAt(0).toUpperCase() + filterStatus.slice(1)} tests`;
                        showToast(`Navigated to UI Testing - showing ${filterText}`, 'success');
                    }
                }, 150);
            };

            // Helper function to apply test filter programmatically
            function applyTestFilter(filterStatus) {
                // Find filter elements
                const testFilterOptions = document.querySelectorAll('#testFilterDropdown .dropdown-option');
                const testFilterBadge = document.querySelector('#testFilterButton .dropdown-badge');

                if (!testFilterOptions.length || !testFilterBadge) {
                    console.error('Test filter elements not found');
                    return;
                }

                // Reset all filter options
                testFilterOptions.forEach(opt => opt.classList.remove('active'));

                // Find and activate the target filter option
                let targetOption = null;
                testFilterOptions.forEach(opt => {
                    const optFilter = opt.getAttribute('data-test-filter');
                    if (optFilter === filterStatus) {
                        opt.classList.add('active');
                        targetOption = opt;
                    }
                });

                if (!targetOption) {
                    console.error(`Filter option for '${filterStatus}' not found`);
                    return;
                }

                // Update filter badge
                testFilterBadge.textContent = targetOption.textContent.trim();
                testFilterBadge.setAttribute('test-status', filterStatus);

                // Trigger the filter update by dispatching a custom event
                document.dispatchEvent(new CustomEvent('apply-test-filter', {
                    detail: { filter: filterStatus }
                }));
            }

            // Add view button click handlers
            function initializeViewButtons() {
                const viewButtons = document.querySelectorAll('.status-view-btn');

                viewButtons.forEach(button => {
                    button.addEventListener('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();

                        // Determine the status from the parent card
                        const card = this.closest('.card');
                        if (!card) return;

                        let filterStatus = 'all';
                        if (card.classList.contains('pass')) {
                            filterStatus = 'pass';
                        } else if (card.classList.contains('fail')) {
                            filterStatus = 'fail';
                        } else if (card.classList.contains('skip')) {
                            filterStatus = 'skip';
                        } else if (card.classList.contains('total')) {
                            filterStatus = 'all';
                        }

                        // Add visual feedback
                        button.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            button.style.transform = '';
                        }, 150);

                        // Navigate with filter
                        navigateToUITestingWithFilter(filterStatus);
                    });

                    // Add keyboard support
                    button.addEventListener('keydown', function (e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            this.click();
                        }
                    });
                });
            }

            document.addEventListener('DOMContentLoaded', function () {
                initializeDashboardAnimations();
                initializeViewButtons();
            });

            // Expose for manual refresh if needed
            window.refreshDashboardAnimations = function () {
                document.querySelectorAll('.status-progress-fill').forEach(bar => {
                    bar.style.transition = 'none';
                    bar.style.width = '0%';
                });
                setTimeout(initializeDashboardAnimations, 100);
            };
        })();
    </script>

    <!-- ================== FEATURE 7: TEST LIST INTERACTIVITY ================== -->
    <script>
        // Handles: No test selected by default, test selection, search, filter, reset, and empty state
        (function () {
            // DOM Elements
            const testListContainer = document.getElementById('test-list-container');
            const testCards = Array.from(testListContainer.querySelectorAll('.test-card-interactive'));
                    const searchInput = document.querySelector('.search-input');
        const searchButton = document.querySelector('.search-btn');
            const filterButton = document.getElementById('testFilterButton');
            const filterDropdown = document.getElementById('testFilterDropdown');
            const filterOptions = Array.from(filterDropdown.querySelectorAll('.dropdown-option'));
            const filterBadge = filterButton.querySelector('.dropdown-badge');
            // Message containers
            let noTestMsg = testListContainer.querySelector('.message-container p')?.textContent?.includes('No Test to Show')
                ? testListContainer.querySelector('.message-container') : null;

            // Helper: Remove all dynamic message containers
            function removeDynamicMessages() {
                testListContainer.querySelectorAll('.message-container[data-dynamic]').forEach(msg => msg.remove());
            }

            // Dynamically create/remove "No search results found" message
            function showNoSearchResultsMsg() {
                removeDynamicMessages();
                if (!testListContainer.querySelector('.message-container[data-dynamic="no-search"]')) {
                    const msgDiv = window.createMessageContainer('\\_()_/', 'No search results found');
                    msgDiv.setAttribute('data-dynamic', 'no-search');
                    testListContainer.appendChild(msgDiv);
                }
            }
            function hideNoSearchResultsMsg() {
                const msgDiv = testListContainer.querySelector('.message-container[data-dynamic="no-search"]');
                if (msgDiv) msgDiv.remove();
            }

            // Show filter-specific empty message
            function showNoFilterResultsMsg(filter) {
                removeDynamicMessages();
                let msg = '';
                let kaomoji = '\\_()_/';
                switch (filter) {
                    case 'pass':
                        msg = 'No passed tests to show';
                        break;
                    case 'fail':
                        msg = 'No failed tests to show';
                        break;
                    case 'skip':
                        msg = 'No skipped tests to show';
                        break;
                    default:
                        msg = 'No tests to show';
                        kaomoji = '\\_()_/';
                }
                const msgDiv = window.createMessageContainer(kaomoji, msg);
                msgDiv.setAttribute('data-dynamic', 'no-filter');
                testListContainer.appendChild(msgDiv);
            }
            function hideNoFilterResultsMsg() {
                const msgDiv = testListContainer.querySelector('.message-container[data-dynamic="no-filter"]');
                if (msgDiv) msgDiv.remove();
            }

            // Helper: Show "No Test to Show" message if no test cards exist
            function showNoTestMsg() {
                // If a static message container already exists, just show it
                if (noTestMsg) {
                    noTestMsg.style.display = '';
                } else {
                    // Otherwise, create and append a new one
                    const msgDiv = window.createMessageContainer('\\_()_/', 'No Test to Show');
                    msgDiv.classList.add('message-container');
                    testListContainer.appendChild(msgDiv);
                    noTestMsg = msgDiv;
                }
            }

            // Helper: Hide "No Test to Show" message
            function hideNoTestMsg() {
                if (noTestMsg) noTestMsg.style.display = 'none';
            }

            // State
            let currentFilter = 'all';
            let currentSearch = '';
            let selectedTestId = null;

            // Helper: Show/hide test cards based on filter/search
            function updateTestList() {
                // Always get the latest test cards (in case DOM changes)
                const testCardsLive = Array.from(testListContainer.querySelectorAll('.test-card'));
                let visibleCount = 0;
                testCardsLive.forEach(card => {
                    const status = card.getAttribute('test-status');
                    const testId = card.getAttribute('data-test-id') || '';
                    const title = card.querySelector('.test-title')?.textContent || '';
                    const tags = Array.from(card.querySelectorAll('.badge')).map(b => b.textContent).join(' ');
                    // Filter logic
                    const matchesFilter = (currentFilter === 'all' || status === currentFilter);
                    // Search logic
                    const searchLower = currentSearch.trim().toLowerCase();
                    const matchesSearch = !searchLower || (
                        testId.toLowerCase().includes(searchLower) ||
                        title.toLowerCase().includes(searchLower) ||
                        tags.toLowerCase().includes(searchLower)
                    );
                    if (matchesFilter && matchesSearch) {
                        card.style.display = '';
                        visibleCount++;
                    } else {
                        card.style.display = 'none';
                    }
                });

                // Show/hide messages
                removeDynamicMessages();

                // If there are no test cards at all, show the "No Test to Show" message
                if (testCardsLive.length === 0) {
                    showNoTestMsg();
                    hideNoSearchResultsMsg();
                    hideNoFilterResultsMsg();
                    return;
                } else {
                    hideNoTestMsg();
                }

                if (visibleCount === 0) {
                    if (currentSearch.trim() !== '') {
                        showNoSearchResultsMsg();
                        hideNoFilterResultsMsg();
                    } else if (currentFilter !== 'all') {
                        showNoFilterResultsMsg(currentFilter);
                        hideNoSearchResultsMsg();
                    } else {
                        // fallback: show "No Test to Show" message
                        showNoTestMsg();
                        hideNoSearchResultsMsg();
                        hideNoFilterResultsMsg();
                    }
                } else {
                    hideNoTestMsg();
                    hideNoSearchResultsMsg();
                    hideNoFilterResultsMsg();
                }
            }

            // Helper: Deselect all test cards
            function deselectAllTests() {
                const testCardsLive = Array.from(testListContainer.querySelectorAll('.test-card'));
                testCardsLive.forEach(card => {
                    card.classList.remove('active');
                    card.setAttribute('aria-selected', 'false');
                });
                selectedTestId = null;
            }

            // Helper: Select a test card
            function selectTest(card) {
                deselectAllTests();
                card.classList.add('active');
                card.setAttribute('aria-selected', 'true');
                selectedTestId = card.getAttribute('data-test-id');
                // Custom event for other scripts to react
                document.dispatchEvent(new CustomEvent('test-selected', { detail: { testId: selectedTestId, status: card.getAttribute('test-status') } }));
            }

            // Click on test card
            // Use event delegation to handle dynamically added/removed test cards
            testListContainer.addEventListener('click', function (e) {
                const card = e.target.closest('.test-card');
                if (card && testListContainer.contains(card)) {
                    selectTest(card);
                }
            });
            // Keyboard navigation for test cards
            testListContainer.addEventListener('keydown', function (e) {
                if ((e.key === 'Enter' || e.key === ' ') && e.target.classList.contains('test-card')) {
                    e.preventDefault();
                    selectTest(e.target);
                }
            });

            // Search input
            searchInput.addEventListener('input', function () {
                currentSearch = this.value;
                updateTestList();
            });
            // Optional: search button click (for accessibility)
            searchButton.addEventListener('click', function () {
                currentSearch = searchInput.value;
                updateTestList();
                searchInput.focus();
            });

            // Filter dropdown toggle
            filterButton.addEventListener('click', function (e) {
                e.stopPropagation();
                filterDropdown.classList.toggle('show');
                filterButton.setAttribute('aria-expanded', filterDropdown.classList.contains('show'));
            });
            // Close dropdown on outside click
            document.addEventListener('click', function (e) {
                if (!filterDropdown.contains(e.target) && !filterButton.contains(e.target)) {
                    filterDropdown.classList.remove('show');
                    filterButton.setAttribute('aria-expanded', 'false');
                }
            });
            // Filter option click
            filterOptions.forEach(opt => {
                opt.addEventListener('click', function () {
                    filterOptions.forEach(o => o.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.getAttribute('data-test-filter');
                    filterBadge.textContent = this.textContent.trim();
                    filterBadge.setAttribute('test-status', currentFilter);
                    updateTestList();
                    // Fix: Hide the dropdown after selecting an option
                    filterDropdown.classList.remove('show');
                    filterButton.setAttribute('aria-expanded', 'false');
                });
            });

            // Listen for programmatic filter changes (from dashboard navigation)
            document.addEventListener('apply-test-filter', function (e) {
                const filterStatus = e.detail.filter;
                currentFilter = filterStatus;

                // Clear search when applying filter from dashboard
                currentSearch = '';
                if (searchInput) {
                    searchInput.value = '';
                }

                // Deselect any selected tests
                deselectAllTests();

                // Reset info and logs panels to default state
                document.dispatchEvent(new CustomEvent('reset-test-panels'));

                // Update the test list display
                updateTestList();
            });

            // Reset filters (optional: add a reset button if needed)
            // Example: double-click filter badge to reset
            filterBadge.addEventListener('dblclick', function () {
                currentFilter = 'all';
                currentSearch = '';
                searchInput.value = '';
                filterOptions.forEach(o => o.classList.remove('active'));
                filterOptions[0].classList.add('active');
                filterBadge.textContent = 'All';
                filterBadge.setAttribute('test-status', 'all');
                updateTestList();
            });

            // On load: no test selected, show default messages in right panel (handled by other scripts)
            deselectAllTests();
            updateTestList();
        })();
    </script>

    <!-- ================== FEATURE 8: TEST INFO PANEL INTERACTIVITY ================== -->
    <script>
        // Handles: Test info panel show/hide, status badge update, accordion expand/collapse, default state, dynamic message container
        (function () {
            // DOM Elements
            const infoSection = document.querySelector('.test-info-section');
            const infoPanels = Array.from(infoSection.querySelectorAll('.test-info-panel'));
            const infoAccordionBtn = document.getElementById('test-info-accordion-toggle');
            const infoAccordionIcon = document.getElementById('test-info-accordion-icon');
            const infoCardBody = infoSection.querySelector('.card-content');
            const infoHeaderStatusBadge = infoSection.querySelector('.status-badge');
            // Track expanded/collapsed state per test
            const expandedState = {};

            // Helper: Create the default message container
            function createDefaultMsgContainer() {
                return window.createMessageContainer('', 'click on a test to view information');
            }

            // Helper: Remove any existing message container
            function removeDefaultMsgContainer() {
                const existing = infoSection.querySelector('.message-container');
                if (existing) existing.remove();
            }

            // Helper: Show default message, hide all panels
            function showDefaultInfoMessage() {
                infoPanels.forEach(panel => panel.classList.add('d-none'));
                removeDefaultMsgContainer();
                // Insert message container at the end of .card-content
                infoCardBody.appendChild(createDefaultMsgContainer());
                // Set status badge to INFO
                if (infoHeaderStatusBadge) {
                    infoHeaderStatusBadge.textContent = 'INFO';
                    infoHeaderStatusBadge.setAttribute('test-status', 'info');
                }
                // Always show expanded without transition
                expandAccordion(false);
            }

            // Helper: Show info for selected test
            function showTestInfo(testId, status) {
                let found = false;
                infoPanels.forEach(panel => {
                    if (panel.getAttribute('data-test-id') === testId) {
                        panel.classList.remove('d-none');
                        found = true;
                    } else {
                        panel.classList.add('d-none');
                    }
                });
                removeDefaultMsgContainer();
                // Update status badge
                if (infoHeaderStatusBadge) {
                    infoHeaderStatusBadge.textContent = status ? status.toUpperCase() : 'INFO';
                    infoHeaderStatusBadge.setAttribute('test-status', status || 'info');
                }
                // Always show expanded unless user has manually collapsed this specific test
                if (expandedState[testId] === false) {
                    // User has manually collapsed this test, keep it collapsed without transition
                    collapseAccordion(false);
                } else {
                    // Show expanded without transition (default behavior)
                    expandAccordion(false);
                }
            }

            // Accordion expand/collapse with smooth transitions (for manual toggle only)
            function expandAccordion(withTransition = true) {
                if (withTransition) {
                    // Smooth transition for manual toggle
                    // Remove collapsed class and measure the natural height
                    infoCardBody.classList.remove('collapsed');
                    const height = infoCardBody.scrollHeight;

                    // Set max-height to 0 first (for smooth transition from collapsed state)
                    infoCardBody.style.maxHeight = '0px';

                    // Force a reflow
                    infoCardBody.offsetHeight;

                    // Now animate to the natural height
                    infoCardBody.style.maxHeight = height + 'px';

                    // Update ARIA and icon
                    infoAccordionBtn.setAttribute('aria-expanded', 'true');
                    if (infoAccordionIcon) {
                        infoAccordionIcon.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                        infoAccordionIcon.style.transform = 'rotate(0deg)';
                    }

                    // After transition, set to 'none' for responsive behavior
                    setTimeout(() => {
                        if (!infoCardBody.classList.contains('collapsed')) {
                            infoCardBody.style.maxHeight = 'none';
                        }
                    }, 400);
                } else {
                    // Instant expand (for test selection)
                    infoCardBody.classList.remove('collapsed');
                    infoCardBody.style.maxHeight = 'none';
                    infoAccordionBtn.setAttribute('aria-expanded', 'true');
                    if (infoAccordionIcon) {
                        infoAccordionIcon.style.transition = 'none';
                        infoAccordionIcon.style.transform = 'rotate(0deg)';
                        // Re-enable transition after instant change
                        setTimeout(() => {
                            if (infoAccordionIcon) {
                                infoAccordionIcon.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                            }
                        }, 50);
                    }
                }
            }

            function collapseAccordion(withTransition = true) {
                if (withTransition) {
                    // Smooth transition for manual toggle
                    // Get current height first
                    const height = infoCardBody.scrollHeight;

                    // Set explicit height
                    infoCardBody.style.maxHeight = height + 'px';

                    // Force a reflow
                    infoCardBody.offsetHeight;

                    // Now animate to 0
                    infoCardBody.style.maxHeight = '0px';

                    // Update ARIA and icon
                    infoAccordionBtn.setAttribute('aria-expanded', 'false');
                    if (infoAccordionIcon) {
                        infoAccordionIcon.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                        infoAccordionIcon.style.transform = 'rotate(180deg)';
                    }

                    // Add collapsed class after a short delay to ensure smooth animation
                    setTimeout(() => {
                        infoCardBody.classList.add('collapsed');
                    }, 400);
                } else {
                    // Instant collapse (for test selection)
                    infoCardBody.classList.add('collapsed');
                    infoCardBody.style.maxHeight = '0px';
                    infoAccordionBtn.setAttribute('aria-expanded', 'false');
                    if (infoAccordionIcon) {
                        infoAccordionIcon.style.transition = 'none';
                        infoAccordionIcon.style.transform = 'rotate(180deg)';
                        // Re-enable transition after instant change
                        setTimeout(() => {
                            if (infoAccordionIcon) {
                                infoAccordionIcon.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                            }
                        }, 50);
                    }
                }
            }

            // Accordion button click (manual toggle with smooth transition)
            infoAccordionBtn?.addEventListener('click', function () {
                // Check current state more reliably
                const isExpanded = infoAccordionBtn.getAttribute('aria-expanded') === 'true';

                if (isExpanded) {
                    // User manually collapsing - use smooth transition
                    collapseAccordion(true);
                } else {
                    // User manually expanding - use smooth transition
                    expandAccordion(true);
                }

                // Remember state for current test
                const activePanel = infoPanels.find(panel => !panel.classList.contains('d-none'));
                if (activePanel) {
                    const testId = activePanel.getAttribute('data-test-id');
                    expandedState[testId] = !isExpanded;
                }
            });

            // Handle window resize to maintain proper accordion behavior
            let resizeTimeout;
            window.addEventListener('resize', function () {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    // If accordion is expanded and not collapsed, reset max-height to 'none'
                    if (!infoCardBody.classList.contains('collapsed') &&
                        infoAccordionBtn.getAttribute('aria-expanded') === 'true') {
                        infoCardBody.style.maxHeight = 'none';
                    }
                }, 250);
            });

            // Listen for test selection event
            document.addEventListener('test-selected', function (e) {
                const { testId, status } = e.detail;
                showTestInfo(testId, status);
            });

            // Listen for panel reset event (from dashboard navigation)
            document.addEventListener('reset-test-panels', function () {
                // Clear any stored expanded states when resetting
                Object.keys(expandedState).forEach(key => {
                    delete expandedState[key];
                });
                showDefaultInfoMessage();
            });

            // On load: show default message, no test selected
            showDefaultInfoMessage();
        })();
    </script>

    <!-- ================== FEATURE 9: TEST LOGS PANEL INTERACTIVITY (DYNAMIC MESSAGE, LOG COUNTS, ACCORDION, FILTER) ================== -->
    <script>
        // Handles: Test logs panel show/hide, dynamic message container, log count badges animation, log content accordion, log filtering
        (function () {
            // --- DOM Elements ---
            const logsSection = document.querySelector('.test-logs-section');
            const logsPanels = Array.from(logsSection.querySelectorAll('.test-logs-panel'));
            const logsCardBody = logsSection.querySelector('.card-content');
            const badgeIds = {
                total: 'total-logs-count',
                pass: 'pass-logs-count',
                fail: 'fail-logs-count',
                skip: 'skip-logs-count',
                info: 'info-logs-count'
            };
            // Log filter
            const logsFilterButton = document.getElementById('logsFilterButton');
            const logsFilterDropdown = document.getElementById('logsFilterDropdown');
            const logsFilterOptions = Array.from(logsFilterDropdown.querySelectorAll('.dropdown-option'));
            const logsFilterBadge = logsFilterButton.querySelector('.dropdown-badge');
            let currentLogFilter = 'all';
            let currentPanel = null;

            // --- Dynamic Message Container ---
            function createDefaultMsgContainer() {
                return window.createMessageContainer('', 'click on a test to view logs');
            }
            function removeDefaultMsgContainer() {
                const existing = logsSection.querySelector('.message-container');
                if (existing) existing.remove();
            }
            function showDefaultLogsMessage() {
                logsPanels.forEach(panel => panel.classList.add('d-none'));
                removeDefaultMsgContainer();
                logsCardBody.appendChild(createDefaultMsgContainer());
                updateLogCounts(null); // Set all badges to 0
            }

            // --- Log Count Animation ---
            function animateBadge(badge, end) {
                const duration = 800;
                const start = 0;
                const startTime = performance.now();
                function update(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const value = Math.round(start + (end - start) * progress);
                    badge.textContent = value;
                    if (progress < 1) {
                        requestAnimationFrame(update);
                    }
                }
                requestAnimationFrame(update);
            }
            function updateLogCounts(panel) {
                const logItems = panel ? Array.from(panel.querySelectorAll('.log-item')) : [];
                const counts = { total: 0, pass: 0, fail: 0, skip: 0, info: 0 };
                logItems.forEach(item => {
                    // Only count visible logs (for filter)
                    if (item.style.display === 'none') return;
                    counts.total++;
                    const status = item.getAttribute('log-status');
                    if (counts[status] !== undefined) counts[status]++;
                });
                Object.keys(badgeIds).forEach(key => {
                    const badge = document.getElementById(badgeIds[key]);
                    if (badge) animateBadge(badge, counts[key]);
                });
            }

            // --- Log Filtering ---
            function filterLogs(panel, status) {
                if (!panel) return;
                const logItems = Array.from(panel.querySelectorAll('.log-item'));
                let visibleCount = 0;
                logItems.forEach(item => {
                    const logStatus = item.getAttribute('log-status');
                    if (status === 'all' || logStatus === status) {
                        item.style.display = '';
                        visibleCount++;
                    } else {
                        item.style.display = 'none';
                    }
                });
                // Always remove any previous no-logs message before adding a new one
                let noLogsMsg = panel.querySelector('.message-container.no-logs');
                if (noLogsMsg) noLogsMsg.remove();

                if (visibleCount === 0) {
                    // Determine message based on filter
                    let msg = 'No Logs to Show';
                    let kaomoji = '\\_()_/';
                    if (status !== 'all') {
                        // Map status to friendly text
                        const statusMap = {
                            pass: 'passed',
                            fail: 'failed',
                            skip: 'skipped',
                            info: 'information'
                        };
                        const friendly = statusMap[status] || status;
                        msg = `No ${friendly} logs to show`;
                    }
                    noLogsMsg = window.createMessageContainer(kaomoji, msg, 'no-logs');
                    panel.appendChild(noLogsMsg);
                }
                updateLogCounts(panel);
            }

            // --- Log Content Accordion Animation (Improved) ---
            function collapseAllLogs(panel) {
                if (!panel) return;
                const allLogs = panel.querySelectorAll('.log-item');
                allLogs.forEach(log => {
                    collapseLogItem(log);
                });
            }

            function collapseLogItem(logItem) {
                logItem.classList.remove('active');
                const content = logItem.querySelector('.expandable-content');
                const toggleBtn = logItem.querySelector('.log-toggle');

                // Update ARIA attribute
                if (toggleBtn) {
                    toggleBtn.setAttribute('aria-expanded', 'false');
                }

                if (content) {
                    // Get current height for smooth transition
                    const currentHeight = content.scrollHeight;
                    content.style.maxHeight = currentHeight + 'px';

                    // Force reflow
                    content.offsetHeight;

                    // Animate to 0
                    content.style.maxHeight = '0px';
                }
            }

            function expandLogItem(logItem) {
                const content = logItem.querySelector('.expandable-content');
                const toggleBtn = logItem.querySelector('.log-toggle');

                // Update ARIA attribute
                if (toggleBtn) {
                    toggleBtn.setAttribute('aria-expanded', 'true');
                }

                if (content) {
                    // Start from collapsed state with explicit 0 height
                    content.style.maxHeight = '0px';

                    // Add active class (this adds padding and triggers CSS transition)
                    logItem.classList.add('active');

                    // Measure target height with active class applied
                    const targetHeight = content.scrollHeight;

                    // Force reflow
                    content.offsetHeight;

                    // Animate to target height
                    content.style.maxHeight = targetHeight + 'px';

                    // Remove setting maxHeight to 'none' after transition
                    // Instead, keep it at the measured value for smooth collapse
                }
            }

            function toggleLogItem(logItem) {
                const panel = logItem.closest('.test-logs-panel');
                const isCurrentlyActive = logItem.classList.contains('active');

                // Prevent multiple rapid toggles during animation
                if (logItem.dataset.animating === 'true') {
                    return;
                }

                // Mark as animating
                logItem.dataset.animating = 'true';

                // Collapse all other logs in the same panel first
                const allLogsInPanel = panel.querySelectorAll('.log-item');
                allLogsInPanel.forEach(item => {
                    if (item !== logItem && item.classList.contains('active')) {
                        collapseLogItem(item);
                    }
                });

                // Toggle the clicked log item
                if (isCurrentlyActive) {
                    collapseLogItem(logItem);
                } else {
                    expandLogItem(logItem);
                }

                // Remove animating flag after transition
                setTimeout(() => {
                    logItem.dataset.animating = 'false';
                }, 450); // Slightly longer than transition duration
            }

            // --- Show logs for selected test ---
            function showTestLogs(testId) {
                let found = false;
                logsPanels.forEach(panel => {
                    if (panel.getAttribute('data-test-id') === testId) {
                        panel.classList.remove('d-none');
                        found = true;
                        currentPanel = panel;
                    } else {
                        panel.classList.add('d-none');
                    }
                });
                removeDefaultMsgContainer();
                if (found) {
                    filterLogs(currentPanel, currentLogFilter);
                    collapseAllLogs(currentPanel);
                } else {
                    currentPanel = null;
                }
            }

            // --- Log Filter Dropdown Events ---
            logsFilterButton.addEventListener('click', function (e) {
                e.stopPropagation();
                logsFilterDropdown.classList.toggle('show');
                logsFilterButton.setAttribute('aria-expanded', logsFilterDropdown.classList.contains('show'));
            });
            document.addEventListener('click', function (e) {
                if (!logsFilterDropdown.contains(e.target) && !logsFilterButton.contains(e.target)) {
                    logsFilterDropdown.classList.remove('show');
                    logsFilterButton.setAttribute('aria-expanded', 'false');
                }
            });
            logsFilterOptions.forEach(opt => {
                opt.addEventListener('click', function () {
                    logsFilterOptions.forEach(o => o.classList.remove('active'));
                    this.classList.add('active');
                    currentLogFilter = this.getAttribute('data-log-filter');
                    logsFilterBadge.textContent = this.textContent.trim();
                    logsFilterBadge.setAttribute('log-status', currentLogFilter);
                    if (currentPanel) filterLogs(currentPanel, currentLogFilter);
                    // Hide the dropdown after selecting an option
                    logsFilterDropdown.classList.remove('show');
                    logsFilterButton.setAttribute('aria-expanded', 'false');
                });
            });
            // Double-click badge to reset
            logsFilterBadge.addEventListener('dblclick', function () {
                currentLogFilter = 'all';
                logsFilterOptions.forEach(o => o.classList.remove('active'));
                logsFilterOptions[0].classList.add('active');
                logsFilterBadge.textContent = 'All';
                logsFilterBadge.setAttribute('log-status', 'all');
                if (currentPanel) filterLogs(currentPanel, currentLogFilter);
            });

            // --- Log Content Toggle Events ---
            logsPanels.forEach(panel => {
                // Click event for log toggle
                panel.addEventListener('click', function (e) {
                    const btn = e.target.closest('.log-toggle');
                    if (btn) {
                        const logItem = btn.closest('.log-item');
                        toggleLogItem(logItem);
                    }
                });

                // Keyboard event for log toggle accessibility
                panel.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        const btn = e.target.closest('.log-toggle');
                        if (btn) {
                            e.preventDefault();
                            const logItem = btn.closest('.log-item');
                            toggleLogItem(logItem);
                        }
                    }
                });

                // Initialize all log contents to collapsed state
                panel.querySelectorAll('.expandable-content').forEach(content => {
                    content.style.maxHeight = '0px';
                });

                // Remove any active classes on initialization and add accessibility attributes
                panel.querySelectorAll('.log-item').forEach(item => {
                    item.classList.remove('active');
                    const toggleBtn = item.querySelector('.log-toggle');
                    if (toggleBtn) {
                        toggleBtn.setAttribute('tabindex', '0');
                        toggleBtn.setAttribute('role', 'button');
                        toggleBtn.setAttribute('aria-expanded', 'false');
                        toggleBtn.setAttribute('aria-label', 'Toggle log details');
                    }
                });
            });

            // --- Listen for test selection event ---
            document.addEventListener('test-selected', function (e) {
                const { testId } = e.detail;
                showTestLogs(testId);
            });

            // --- Listen for panel reset event (from dashboard navigation) ---
            document.addEventListener('reset-test-panels', function () {
                // Reset log filter to 'all'
                currentLogFilter = 'all';
                logsFilterOptions.forEach(o => o.classList.remove('active'));
                if (logsFilterOptions[0]) {
                    logsFilterOptions[0].classList.add('active');
                }
                if (logsFilterBadge) {
                    logsFilterBadge.textContent = 'All';
                    logsFilterBadge.setAttribute('log-status', 'all');
                }

                // Collapse all log items in all panels
                logsPanels.forEach(panel => {
                    collapseAllLogs(panel);
                });

                // Show default message
                showDefaultLogsMessage();
            });

            // --- Handle window resize for responsive log content ---
            let logResizeTimeout;
            window.addEventListener('resize', function () {
                clearTimeout(logResizeTimeout);
                logResizeTimeout = setTimeout(() => {
                    // Recalculate heights for all expanded log items
                                document.querySelectorAll('.log-item.active').forEach(logItem => {
                const content = logItem.querySelector('.expandable-content');
                        if (content) {
                            // Set maxHeight to the new scrollHeight
                            content.style.maxHeight = content.scrollHeight + 'px';
                        }
                    });
                }, 250);
            });

            // --- On load: show default message, no test selected ---
            showDefaultLogsMessage();
        })();
    </script>

    <!-- ================== FEATURE 10: EXPORT & DROPDOWN FUNCTIONALITY ================== -->
    <script>
        (function () {
            // --- Dropdown mutual exclusion logic ---
            function closeAllDropdowns(exceptId) {
                document.querySelectorAll('.dropdown-menu.show').forEach(menu => {
                    if (!exceptId || menu.id !== exceptId) menu.classList.remove('show');
                });
            }
            // --- Export dropdown show/hide ---
            const exportBtn = document.getElementById('exportButton');
            const exportDropdown = document.getElementById('exportDropdown');
            exportBtn?.addEventListener('click', function (e) {
                e.stopPropagation();
                const isOpen = exportDropdown.classList.contains('show');
                closeAllDropdowns('exportDropdown');
                if (!isOpen) exportDropdown.classList.add('show');
            });
            // --- Filter dropdowns mutual exclusion ---
            const testFilterButton = document.getElementById('testFilterButton');
            const testFilterDropdown = document.getElementById('testFilterDropdown');
            testFilterButton?.addEventListener('click', function (e) {
                e.stopPropagation();
                const isOpen = testFilterDropdown.classList.contains('show');
                closeAllDropdowns('testFilterDropdown');
                if (!isOpen) testFilterDropdown.classList.add('show');
            });
            const logsFilterButton = document.getElementById('logsFilterButton');
            const logsFilterDropdown = document.getElementById('logsFilterDropdown');
            logsFilterButton?.addEventListener('click', function (e) {
                e.stopPropagation();
                const isOpen = logsFilterDropdown.classList.contains('show');
                closeAllDropdowns('logsFilterDropdown');
                if (!isOpen) logsFilterDropdown.classList.add('show');
            });
            document.addEventListener('click', function (e) {
                // Close all dropdowns if click outside
                if (!exportBtn.contains(e.target) && !exportDropdown.contains(e.target)
                    && !testFilterButton.contains(e.target) && !testFilterDropdown.contains(e.target)
                    && !logsFilterButton.contains(e.target) && !logsFilterDropdown.contains(e.target)) {
                    closeAllDropdowns();
                }
            });
            // --- Export logic ---
            function getCurrentDateTimeString() {
                const now = new Date();
                const pad = n => n.toString().padStart(2, '0');
                return `${pad(now.getDate())}-${now.toLocaleString('en-US', { month: 'short' })}-${now.getFullYear().toString().slice(-2)}_${pad(now.getHours())}-${pad(now.getMinutes())}-${pad(now.getSeconds())}-${pad(now.getMilliseconds()).slice(0, 2)}`;
            }
            function sanitize(str) {
                return (str || '').replace(/"/g, '""');
            }
            function hasScreenshot(logItem) {
                const btn = logItem.querySelector('button[data-modal="image"]');
                return !!(btn && btn.getAttribute('data-image-url'));
            }
            function getTestDetailsFromCard(card) {
                return {
                    id: card.getAttribute('data-test-id'),
                    name: card.querySelector('.test-title')?.textContent || '',
                    status: card.getAttribute('test-status'),
                    date: card.querySelector('.test-metadata-item span')?.textContent || '',
                    time: card.querySelectorAll('.test-metadata-item span')[1]?.textContent || '',
                    tags: Array.from(card.querySelectorAll('.badge')).map(b => b.textContent),
                };
            }
            function getTestLogsFromPanel(panel) {
                return Array.from(panel.querySelectorAll('.log-item')).map(item => ({
                    logId: item.getAttribute('data-log-id'),
                    status: item.getAttribute('log-status'),
                                         name: item.querySelector('.log-name')?.textContent || '',
                     time: item.querySelector('.log-time-col')?.textContent || '',
                     message: item.querySelector('.log-message-col p')?.textContent || '',
                    screenshot: hasScreenshot(item)
                }));
            }
            function getAllTestCards() {
                return Array.from(document.querySelectorAll('.test-card'));
            }
            function getLogsPanelForTestId(testId) {
                return document.querySelector(`.test-logs-panel[data-test-id="${testId}"]`);
            }
            function toCSVRow(arr) {
                return arr.map(v => `"${sanitize(v)}"`).join(',');
            }
            function exportCurrentTest(as) {
                const card = document.querySelector('.test-card.active');
                if (!card) {
                    if (typeof window.showToast === 'function') {
                        showToast('Please select a test to export.', 'warning');
                    } else {
                        alert('Please select a test to export.');
                    }
                    return;
                }
                const details = getTestDetailsFromCard(card);
                const logsPanel = getLogsPanelForTestId(details.id);
                const logs = logsPanel ? getTestLogsFromPanel(logsPanel) : [];
                const dt = getCurrentDateTimeString();
                const filename = `${details.id}_${details.status ? details.status.toUpperCase() : ''}_${dt}.${as}`;
                if (as === 'csv') {
                    let csv = 'Test ID,Test Name,Status,Date,Time,Tags\n';
                    csv += toCSVRow([details.id, details.name, details.status, details.date, details.time, details.tags.join(';')]) + '\n';
                    csv += '\nLogs:\nLog ID,Status,Name,Time,Message,Screenshot\n';
                    logs.forEach(log => {
                        csv += toCSVRow([log.logId, log.status, log.name, log.time, log.message, log.screenshot ? 'true' : 'false']) + '\n';
                    });
                    downloadFile(csv, filename, 'text/csv');
                } else if (as === 'json') {
                    const json = JSON.stringify({ details, logs }, null, 2);
                    downloadFile(json, filename, 'application/json');
                }
                if (typeof window.showToast === 'function') {
                    showToast('Exported current test as ' + as.toUpperCase() + '!', 'success');
                }
            }
            function exportAllTests(as) {
                const cards = getAllTestCards();
                const all = cards.map(card => {
                    const details = getTestDetailsFromCard(card);
                    const logsPanel = getLogsPanelForTestId(details.id);
                    const logs = logsPanel ? getTestLogsFromPanel(logsPanel) : [];
                    return { details, logs };
                });
                const dt = getCurrentDateTimeString();
                const filename = `ALL_TESTS_${dt}.${as}`;
                if (as === 'csv') {
                    let csv = 'Test ID,Test Name,Status,Date,Time,Tags\n';
                    all.forEach(({ details }) => {
                        csv += toCSVRow([details.id, details.name, details.status, details.date, details.time, details.tags.join(';')]) + '\n';
                    });
                    csv += '\nLogs:\nTest ID,Log ID,Status,Name,Time,Message,Screenshot\n';
                    all.forEach(({ details, logs }) => {
                        logs.forEach(log => {
                            csv += toCSVRow([details.id, log.logId, log.status, log.name, log.time, log.message, log.screenshot ? 'true' : 'false']) + '\n';
                        });
                    });
                    downloadFile(csv, filename, 'text/csv');
                } else if (as === 'json') {
                    const json = JSON.stringify(all, null, 2);
                    downloadFile(json, filename, 'application/json');
                }
                if (typeof window.showToast === 'function') {
                    showToast('Exported all tests as ' + as.toUpperCase() + '!', 'success');
                }
            }
            function downloadFile(content, filename, mime) {
                const blob = new Blob([content], { type: mime });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            exportDropdown.addEventListener('click', function (e) {
                const opt = e.target.closest('.dropdown-option');
                if (!opt) return;
                const type = opt.getAttribute('data-export-type');
                exportDropdown.classList.remove('show');
                if (type === 'csv') exportCurrentTest('csv');
                else if (type === 'json') exportCurrentTest('json');
                else if (type === 'all-csv') exportAllTests('csv');
                else if (type === 'all-json') exportAllTests('json');
            });
        })();
    </script>

    <!-- ================== FEATURE 11: TOAST MESSAGES ================== -->
    <script>
        (function () {
            // Optimized toast implementation using atomic classes
            window.showToast = function (message, type = 'info') {
                const container = document.getElementById('toastContainer');
                if (!container) return;
                const toast = document.createElement('div');
                // Using atomic classes: py-14 px-28 rounded-lg text-xs font-normal mt-8 shadow-toast pointer-events-auto
                toast.className = `toast-message py-14 px-28 rounded-lg text-xs font-normal mt-8 shadow-toast pointer-events-auto bg-${type} text-${type}`;
                toast.textContent = message;
                container.appendChild(toast);
                setTimeout(() => {
                    toast.style.opacity = 0;
                    setTimeout(() => {
                        toast.remove();
                    }, 500);
                }, 3000);
            };
        })();
    </script>

    <!-- ================== FEATURE 12: DASHBOARD CHARTS GRID ================== -->
    <script>
        (function () {
            function updateDashboardChartsGridClass() {
                var grid = document.querySelector('.grid-1x3');
                if (!grid) return;
                var cards = grid.querySelectorAll('article');
                grid.classList.toggle('two-cards', cards.length === 2);
            }
            document.addEventListener('DOMContentLoaded', updateDashboardChartsGridClass);
        })();
    </script>

    <!-- ================== FEATURE 13: Media Modal (Image/Annotation/Zoom/Download) ================== -->
    <script>
        const MediaModal = (function () {
            // --- DOM Elements ---
                    const modal = document.getElementById('mediaModal');
        const modalTitle = document.getElementById('modalLogId');
            const mediaContainer = document.getElementById('imageContainer');
            const zoomWrapper = document.getElementById('mediaZoomWrapper');
            const modalImage = document.getElementById('modalImage');
            const loadingContainer = document.querySelector('.loading-container');
            const annotationCanvas = document.getElementById('annotationCanvas');
            const annotationTools = document.getElementById('annotationTools');
            const annotateBtn = document.getElementById('annotateBtn');

            // --- State Variables ---
            let ctx = annotationCanvas.getContext('2d');
            let currentColor = '#FF0000';
            let currentZoom = 1, MIN_ZOOM = 0.5, MAX_ZOOM = 5, ZOOM_STEP = 0.25;
            let isAnnotating = false, isPanning = false, isDrawing = false;
            let lastPanX = 0, lastPanY = 0, translateX = 0, translateY = 0;
            let startX = 0, startY = 0;
            let currentLogId = '';
            let currentShape = 'rectangle';
            let isClosing = false; // Flag to prevent error on close
            let currentBlobUrl = null; // Track the current blob URL for cleanup

            // --- Annotation History ---
            let drawnShapes = [];
            let undoStack = [];
            let canvasSnapshot = null; // For efficient shape previews

            function init() {
                // --- Modal Listeners ---
                modal.querySelector('button[data-tooltip="Close"]').addEventListener('click', closeModal);
                modal.addEventListener('click', e => { if (e.target === modal) closeModal(); });

                // --- Control Button Listeners ---
                document.getElementById('zoomIn').addEventListener('click', () => zoom(ZOOM_STEP));
                document.getElementById('zoomOut').addEventListener('click', () => zoom(-ZOOM_STEP));
                document.getElementById('reset').addEventListener('click', resetAll);
                document.getElementById('downloadBtn').addEventListener('click', downloadImage);
                annotateBtn.addEventListener('click', toggleAnnotationMode);

                // --- Annotation Tool Listeners ---
                document.querySelectorAll('.color-option').forEach(opt => {
                    opt.addEventListener('click', e => {
                        document.querySelector('.color-option.active').classList.remove('active');
                        e.target.classList.add('active');
                        currentColor = e.target.getAttribute('data-color') || e.target.style.backgroundColor;
                    });
                });

                document.querySelectorAll('.shape-btn[data-shape]').forEach(btn => {
                    btn.addEventListener('click', e => {
                        document.querySelectorAll('.shape-btn').forEach(b => b.classList.remove('active'));
                        e.currentTarget.classList.add('active');
                        currentShape = e.currentTarget.getAttribute('data-shape');
                    });
                });

                document.getElementById('undoBtn').addEventListener('click', undo);
                document.getElementById('redoBtn').addEventListener('click', redo);
                document.getElementById('clearAnnotations').addEventListener('click', () => {
                    drawnShapes = [];
                    undoStack = [];
                    redrawCanvas();
                });

                // --- Core Event Setup ---
                setupCanvasEvents();
                setupPanningEvents();
                document.addEventListener('keydown', handleKeyboardShortcuts);

                // --- Setup Resize Observer ---
                if (window.ResizeObserver) {
                    const resizeObserver = new ResizeObserver(() => {
                        if (modal.style.display === 'block') {
                            syncCanvasToImage();
                            redrawCanvas();
                        }
                    });
                    resizeObserver.observe(modalImage);
                }
            }

            // --- Modal Lifecycle ---
            function openModal({ src, title = 'Screenshot', logId = '' } = {}) {
                if (!src) return showError('No image source provided');

                isClosing = false; // Reset flag on open
                drawnShapes = [];
                undoStack = [];
                currentLogId = logId;

                // Helper to safely revoke previous blob URL after image is no longer referencing it
                function safeRevokeBlobUrl() {
                    if (currentBlobUrl) {
                        URL.revokeObjectURL(currentBlobUrl);
                        currentBlobUrl = null;
                    }
                }
                // If a previous blob URL exists, clear the image src and wait for load/error before revoking
                if (currentBlobUrl) {
                    modalImage.onload = modalImage.onerror = function () {
                        safeRevokeBlobUrl();
                        modalImage.onload = modalImage.onerror = null;
                    };
                    modalImage.src = '';
                } else {
                    safeRevokeBlobUrl();
                }

                resetZoomAndPan();
                disableAnnotationMode();
                showLoading(true);
                modalTitle.textContent = title;
                modal.style.display = 'block';
                modalImage.src = '';
                // Reset error message
                const errorDiv = document.getElementById('mediaErrorMessage');
                if (errorDiv) errorDiv.style.display = 'none';
                mediaContainer.style.display = 'flex';

                // Show loading progress
                let progressText = loadingContainer.querySelector('.loading-progress');
                if (!progressText) {
                    progressText = document.createElement('div');
                    progressText.className = 'loading-progress';
                    progressText.style.fontSize = '13px';
                    progressText.style.marginTop = '6px';
                    loadingContainer.appendChild(progressText);
                }
                progressText.textContent = '0%';

                // Use XMLHttpRequest to load image with progress
                const xhr = new XMLHttpRequest();
                xhr.open('GET', src, true);
                xhr.responseType = 'blob';
                xhr.onprogress = function (e) {
                    if (e.lengthComputable) {
                        let percent = Math.round((e.loaded / e.total) * 100);
                        progressText.textContent = percent + '%';
                    } else {
                        progressText.textContent = 'Loading...';
                    }
                };
                xhr.onload = function () {
                    if (xhr.status === 200) {
                        progressText.textContent = '100%';
                        currentBlobUrl = URL.createObjectURL(xhr.response);
                        modalImage.onload = () => {
                            syncCanvasToImage();
                            redrawCanvas();
                            showLoading(false);
                            setTimeout(() => { progressText.textContent = ''; }, 500);
                        };
                        modalImage.onerror = () => {
                            if (!isClosing) showError('Failed to display image after download.');
                        };
                        modalImage.src = currentBlobUrl;
                    } else {
                        showError('Failed to load image (HTTP ' + xhr.status + ')');
                    }
                };
                xhr.onerror = function () {
                    showError('Failed to load image (network error)');
                };
                xhr.send();
            }

            function closeModal() {
                isClosing = true; // Set flag to prevent error on src clear
                modal.style.display = 'none';
                // Remove the image src and wait for load/error before revoking blob URL
                if (currentBlobUrl) {
                    modalImage.onload = modalImage.onerror = function () {
                        if (currentBlobUrl) {
                            URL.revokeObjectURL(currentBlobUrl);
                            currentBlobUrl = null;
                        }
                        modalImage.onload = modalImage.onerror = null;
                    };
                    modalImage.src = '';
                }
                disableAnnotationMode();
                // Revoke blob URL when modal is closed
                if (currentBlobUrl) {
                    URL.revokeObjectURL(currentBlobUrl);
                    currentBlobUrl = null;
                }
            }

            function showLoading(flag) { loadingContainer.style.display = flag ? 'flex' : 'none'; }

            function showError(message) {
                showLoading(false);
                mediaContainer.style.display = 'none';
                const errorDiv = document.getElementById('mediaErrorMessage');
                if (errorDiv) {
                    // Remove any previous content
                    errorDiv.innerHTML = '';
                    // Use global createMessageContainer if available
                    let msgNode;
                    if (window.createMessageContainer) {
                        msgNode = window.createMessageContainer('', message);
                    } else {
                        msgNode = document.createElement('div');
                        msgNode.textContent = message;
                        msgNode.style.color = '#f44336';
                    }
                    errorDiv.appendChild(msgNode);
                    errorDiv.style.display = 'flex';
                    errorDiv.style.alignItems = 'center';
                    errorDiv.style.justifyContent = 'center';
                }
            }

            // --- Zoom and Pan ---
            function zoom(delta) {
                currentZoom = Math.max(MIN_ZOOM, Math.min(MAX_ZOOM, currentZoom + delta));
                updateTransform();
            }

            function resetZoomAndPan() {
                currentZoom = 1; translateX = 0; translateY = 0;
                updateTransform();
            }

            function resetAll() {
                resetZoomAndPan();
                drawnShapes = []; undoStack = [];
                redrawCanvas();
            }

            function updateTransform() {
                zoomWrapper.style.transform = `translate(${translateX}px, ${translateY}px) scale(${currentZoom})`;
            }

            function setupPanningEvents() {
                mediaContainer.addEventListener('mousedown', e => {
                    if (e.button !== 0 || isAnnotating || currentZoom <= 1) return;
                    isPanning = true; lastPanX = e.clientX; lastPanY = e.clientY;
                    mediaContainer.style.cursor = 'grabbing';
                });
                document.addEventListener('mousemove', e => {
                    if (!isPanning) return;
                    translateX += e.clientX - lastPanX; translateY += e.clientY - lastPanY;
                    lastPanX = e.clientX; lastPanY = e.clientY;
                    updateTransform();
                });
                document.addEventListener('mouseup', () => {
                    if (isPanning) {
                        isPanning = false;
                        mediaContainer.style.cursor = 'grab';
                    }
                });
            }

            // --- Annotation ---
            function setupCanvasEvents() {
                annotationCanvas.addEventListener('mousedown', e => {
                    if (e.button !== 0 || !isAnnotating) return;
                    const rect = annotationCanvas.getBoundingClientRect();
                    const scaleX = annotationCanvas.width / rect.width;
                    const scaleY = annotationCanvas.height / rect.height;
                    const x = (e.clientX - rect.left) * scaleX;
                    const y = (e.clientY - rect.top) * scaleY;

                    startX = x; startY = y;
                    isDrawing = true;
                    undoStack = [];

                    canvasSnapshot = ctx.getImageData(0, 0, annotationCanvas.width, annotationCanvas.height);
                });

                annotationCanvas.addEventListener('mousemove', e => {
                    if (!isDrawing) return;
                    const rect = annotationCanvas.getBoundingClientRect();
                    const scaleX = annotationCanvas.width / rect.width;
                    const scaleY = annotationCanvas.height / rect.height;
                    const x = (e.clientX - rect.left) * scaleX;
                    const y = (e.clientY - rect.top) * scaleY;

                    if (canvasSnapshot) ctx.putImageData(canvasSnapshot, 0, 0);
                    drawShape(startX, startY, x, y, false);
                });

                annotationCanvas.addEventListener('mouseup', e => {
                    if (!isDrawing) return;
                    const rect = annotationCanvas.getBoundingClientRect();
                    const scaleX = annotationCanvas.width / rect.width;
                    const scaleY = annotationCanvas.height / rect.height;
                    const x = (e.clientX - rect.left) * scaleX;
                    const y = (e.clientY - rect.top) * scaleY;

                    isDrawing = false;
                    if (canvasSnapshot) {
                        ctx.putImageData(canvasSnapshot, 0, 0);
                        canvasSnapshot = null;
                    }
                    drawShape(startX, startY, x, y, true);
                    redrawCanvas();
                });
            }

            function drawShape(fromX, fromY, toX, toY, isFinal) {
                const shapeData = { type: currentShape, color: currentColor, lineWidth: 3 };
                switch (currentShape) {
                    case 'rectangle':
                        shapeData.x = Math.min(fromX, toX); shapeData.y = Math.min(fromY, toY);
                        shapeData.width = Math.abs(toX - fromX); shapeData.height = Math.abs(toY - fromY);
                        ctx.beginPath();
                        ctx.rect(shapeData.x, shapeData.y, shapeData.width, shapeData.height);
                        ctx.strokeStyle = currentColor;
                        ctx.stroke();
                        break;
                    case 'circle':
                        shapeData.cx = fromX; shapeData.cy = fromY;
                        shapeData.radius = Math.sqrt(Math.pow(toX - fromX, 2) + Math.pow(toY - fromY, 2));
                        ctx.beginPath();
                        ctx.arc(shapeData.cx, shapeData.cy, shapeData.radius, 0, 2 * Math.PI);
                        ctx.strokeStyle = currentColor;
                        ctx.stroke();
                        break;
                    case 'line':
                        shapeData.fromX = fromX; shapeData.fromY = fromY;
                        shapeData.toX = toX; shapeData.toY = toY;
                        ctx.beginPath();
                        ctx.moveTo(fromX, fromY);
                        ctx.lineTo(toX, toY);
                        ctx.strokeStyle = currentColor;
                        ctx.stroke();
                        break;
                    case 'arrow':
                        shapeData.fromX = fromX; shapeData.fromY = fromY;
                        shapeData.toX = toX; shapeData.toY = toY;
                        drawArrow(ctx, fromX, fromY, toX, toY, currentColor);
                        break;
                }
                if (isFinal) drawnShapes.push(shapeData);
            }



            function redrawCanvas() {
                ctx.clearRect(0, 0, annotationCanvas.width, annotationCanvas.height);
                drawnShapes.forEach(shape => {
                    ctx.strokeStyle = shape.color;
                    ctx.fillStyle = shape.color;
                    ctx.lineWidth = shape.lineWidth || 3;

                    switch (shape.type) {
                        case 'rectangle':
                            ctx.beginPath();
                            ctx.rect(shape.x, shape.y, shape.width, shape.height);
                            ctx.stroke();
                            break;
                        case 'circle':
                            ctx.beginPath();
                            ctx.arc(shape.cx, shape.cy, shape.radius, 0, 2 * Math.PI);
                            ctx.stroke();
                            break;
                        case 'line':
                            ctx.beginPath();
                            ctx.moveTo(shape.fromX, shape.fromY);
                            ctx.lineTo(shape.toX, shape.toY);
                            ctx.stroke();
                            break;
                        case 'arrow':
                            drawArrow(ctx, shape.fromX, shape.fromY, shape.toX, shape.toY, shape.color);
                            break;

                    }
                });
            }

            function drawArrow(context, fromX, fromY, toX, toY, color) {
                const headLength = 15;
                const angle = Math.atan2(toY - fromY, toX - fromX);

                context.beginPath();
                context.moveTo(fromX, fromY);
                context.lineTo(toX, toY);
                context.strokeStyle = color;
                context.stroke();

                context.beginPath();
                context.moveTo(toX, toY);
                context.lineTo(toX - headLength * Math.cos(angle - Math.PI / 6), toY - headLength * Math.sin(angle - Math.PI / 6));
                context.moveTo(toX, toY);
                context.lineTo(toX - headLength * Math.cos(angle + Math.PI / 6), toY - headLength * Math.sin(angle + Math.PI / 6));
                context.stroke();
            }

            function undo() {
                if (drawnShapes.length > 0) {
                    undoStack.push(drawnShapes.pop());
                    redrawCanvas();
                }
            }

            function redo() {
                if (undoStack.length > 0) {
                    drawnShapes.push(undoStack.pop());
                    redrawCanvas();
                }
            }

            function toggleAnnotationMode() {
                isAnnotating = !isAnnotating;
                annotateBtn.classList.toggle('active', isAnnotating);
                annotationTools.style.display = isAnnotating ? 'flex' : 'none';
                annotationCanvas.style.pointerEvents = isAnnotating ? 'auto' : 'none';
                mediaContainer.style.cursor = isAnnotating ? 'crosshair' : (currentZoom > 1 ? 'grab' : 'default');

                if (isAnnotating && !document.querySelector('.shape-btn.active')) {
                    const defaultShapeBtn = document.querySelector('.shape-btn[data-shape="rectangle"]');
                    if (defaultShapeBtn) {
                        defaultShapeBtn.classList.add('active');
                        currentShape = 'rectangle';
                    }
                }
            }

            function disableAnnotationMode() {
                if (isAnnotating) toggleAnnotationMode();
            }

            async function downloadImage() {
                const downloadBtn = document.getElementById('downloadBtn');
                const iconSpan = downloadBtn.querySelector('.download-btn-icon');
                const loadingSpan = downloadBtn.querySelector('.download-btn-loading');
                if (iconSpan && loadingSpan) {
                    iconSpan.style.display = 'none';
                    loadingSpan.style.display = 'inline-block';
                }
                try {
                    // 1. Fetch the image data (works for URLs, relative paths, and base64)
                    const response = await fetch(modalImage.src);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const blob = await response.blob();

                    // 2. Create a temporary image element from the blob
                    const image = await new Promise((resolve, reject) => {
                        const img = new Image();
                        img.onload = () => resolve(img);
                        img.onerror = () => reject(new Error('Could not load the fetched image blob.'));
                        img.src = URL.createObjectURL(blob);
                    });

                    // 3. Create a canvas and draw the original image and annotations
                    const canvas = document.createElement('canvas');
                    canvas.width = image.width;
                    canvas.height = image.height;
                    const ctx2 = canvas.getContext('2d');

                    ctx2.drawImage(image, 0, 0); // Draw the fetched image
                    URL.revokeObjectURL(image.src); // Clean up the object URL

                    ctx2.drawImage(annotationCanvas, 0, 0); // Overlay annotations

                    // 4. Trigger download
                    const link = document.createElement('a');
                    // Show success toast before download
                    showToast('Screenshot download started!', 'success');
                    // Use TESTID_LOGID_Screenshot.png format
                    let testId = '';
                    let logId = '';
                    // Try to get testId from the selected test card
                    const activeTestCard = document.querySelector('.test-card.active');
                    if (activeTestCard) {
                        testId = activeTestCard.getAttribute('data-test-id') || '';
                    }
                    // logId is from currentLogId (e.g., 'Log #1')
                    if (currentLogId) {
                        logId = currentLogId.replace(/[^a-zA-Z0-9_-]/g, '');
                    }
                    let fileName = '';
                    if (testId && logId) {
                        fileName = `${testId}_${logId}_Screenshot.png`;
                    } else if (testId) {
                        fileName = `${testId}_Screenshot.png`;
                    } else if (logId) {
                        fileName = `${logId}_Screenshot.png`;
                    } else {
                        fileName = `Screenshot.png`;
                    }
                    link.download = fileName;
                    link.href = canvas.toDataURL('image/png');
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    // Restore icon after download
                    if (iconSpan && loadingSpan) {
                        iconSpan.style.display = 'inline-block';
                        loadingSpan.style.display = 'none';
                    }
                } catch (err) {
                    console.error('Download failed:', err);
                    showToast(`Failed to download image: ${err.message}. This can happen with protected images. Please try again or take a screenshot.`, 'danger');
                    // Restore icon on error
                    if (iconSpan && loadingSpan) {
                        iconSpan.style.display = 'inline-block';
                        loadingSpan.style.display = 'none';
                    }
                }
            }


            function syncCanvasToImage() {
                const rect = modalImage.getBoundingClientRect();
                annotationCanvas.style.width = `${rect.width}px`;
                annotationCanvas.style.height = `${rect.height}px`;
                annotationCanvas.width = modalImage.naturalWidth;
                annotationCanvas.height = modalImage.naturalHeight;
                ctx = annotationCanvas.getContext('2d');
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                ctx.strokeStyle = currentColor;
                ctx.fillStyle = currentColor;
            }

            function handleKeyboardShortcuts(e) {
                if (modal.style.display !== 'block' || /TEXTAREA|INPUT/.test(e.target.tagName)) return;

                switch (e.key.toLowerCase()) {
                    case 'escape': e.preventDefault(); closeModal(); break;
                    case '+': case '=': e.preventDefault(); zoom(ZOOM_STEP); break;
                    case '-': e.preventDefault(); zoom(-ZOOM_STEP); break;
                    case 'a': if (e.shiftKey) { e.preventDefault(); toggleAnnotationMode(); } break;
                    case 'd': if (e.shiftKey) { e.preventDefault(); downloadImage(); } break;
                    case 'r': if (e.shiftKey) { e.preventDefault(); resetAll(); } break;
                    case 'z': if ((e.ctrlKey || e.metaKey) && isAnnotating) { e.preventDefault(); undo(); } break;
                    case 'y': if ((e.ctrlKey || e.metaKey) && isAnnotating) { e.preventDefault(); redo(); } break;
                }
            }

            return { init, openScreenshotModal: openModal };
        })();

        document.addEventListener('DOMContentLoaded', MediaModal.init);
        window.initializeMediaModal = function () {
            document.querySelectorAll('[data-modal="image"]').forEach(btn => {
                btn.onclick = function (e) {
                    e.stopPropagation();
                    const logId = this.getAttribute('data-log-id');
                    const imageUrl = this.getAttribute('data-image-url');
                    MediaModal.openScreenshotModal({ src: imageUrl, title: logId, logId });
                };
            });
        };
    </script>

    <!-- ================== FEATURE 14: MEDIA MODAL (IMAGE/ANNOTATION/ZOOM/DOWNLOAD) - loading image from test ================== -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize MediaModal utility (already done)
            if (window.initializeMediaModal) {
                window.initializeMediaModal();
            } else {
                // Fallback: add click listeners directly if needed
                document.querySelectorAll('[data-modal="image"]').forEach(function (btn) {
                    btn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        var logId = this.getAttribute('data-log-id');
                        var imageUrl = this.getAttribute('data-image-url');
                        if (window.MediaModal && typeof window.MediaModal.openScreenshotModal === 'function') {
                            window.MediaModal.openScreenshotModal({ src: imageUrl, title: logId, logId: logId });
                        }
                    });
                });
            }
        });
    </script>

</body>

</html>
